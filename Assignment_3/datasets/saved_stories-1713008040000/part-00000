{"aid": "40020756", "title": "Tetris-inspired detector with neural network for radiation mapping", "url": "https://www.nature.com/articles/s41467-024-47338-w", "domain": "nature.com", "votes": 1, "user": "taubek", "posted_at": "2024-04-13 05:31:46", "comments": 0, "source_title": "Tetris-inspired detector with neural network for radiation mapping", "source_text": "Tetris-inspired detector with neural network for radiation mapping | Nature Communications\n\nLoading [MathJax]/jax/output/HTML-CSS/config.js\n\nSkip to main content\n\nThank you for visiting nature.com. You are using a browser version with\nlimited support for CSS. To obtain the best experience, we recommend you use a\nmore up to date browser (or turn off compatibility mode in Internet Explorer).\nIn the meantime, to ensure continued support, we are displaying the site\nwithout styles and JavaScript.\n\nAdvertisement\n\n  * View all journals\n  * Search\n\n## Search\n\nAdvanced search\n\n### Quick links\n\n    * Explore articles by subject\n    * Find a job\n    * Guide to authors\n    * Editorial policies\n\n  * Log in\n\n  * Explore content\n  * About the journal\n  * Publish with us\n\n  * Sign up for alerts\n  * RSS feed\n\nTetris-inspired detector with neural network for radiation mapping\n\nDownload PDF\n\nDownload PDF\n\n  * Article\n  * Open access\n  * Published: 09 April 2024\n\n# Tetris-inspired detector with neural network for radiation mapping\n\n  * Ryotaro Okabe ORCID: orcid.org/0000-0002-5095-5951^1,2^ na1,\n  * Shangjie Xue^1,3,4^ na1,\n  * Jayson R. Vavrek^5^ na1,\n  * Jiankai Yu ORCID: orcid.org/0000-0001-8029-9847^3,\n  * Ryan Pavlovsky^5,\n  * Victor Negut^5,\n  * Brian J. Quiter^5,\n  * Joshua W. Cates^5,\n  * Tongtong Liu^1,6,\n  * Benoit Forget^3,\n  * Stefanie Jegelka ORCID: orcid.org/0000-0002-6121-9474^4,\n  * Gordon Kohse^7,\n  * Lin-wen Hu ORCID: orcid.org/0000-0003-3126-2225^7 &\n  * ...\n  * Mingda Li ORCID: orcid.org/0000-0002-7055-6368^1,3\n\nNature Communications volume 15, Article number: 3061 (2024) Cite this article\n\n  * 511 Accesses\n\n  * 67 Altmetric\n\n  * Metrics details\n\n## Abstract\n\nRadiation mapping has attracted widespread research attention and increased\npublic concerns on environmental monitoring. Regarding materials and their\nconfigurations, radiation detectors have been developed to identify the\nposition and strength of the radioactive sources. However, due to the complex\nmechanisms of radiation-matter interaction and data limitation, high-\nperformance and low-cost radiation mapping is still challenging. Here, we\npresent a radiation mapping framework using Tetris-inspired detector pixels.\nApplying inter-pixel padding for enhancing contrast between pixels and neural\nnetworks trained with Monte Carlo (MC) simulation data, a detector with as few\nas four pixels can achieve high-resolution directional prediction. A moving\ndetector with Maximum a Posteriori (MAP) further achieved radiation position\nlocalization. Field testing with a simple detector has verified the capability\nof the MAP method for source localization. Our framework offers an avenue for\nhigh-quality radiation mapping with simple detector configurations and is\nanticipated to be deployed for real-world radiation detection.\n\n### Similar content being viewed by others\n\n### A versatile single-photon-based quantum computing platform\n\nArticle Open access 26 March 2024\n\nNicolas Maring, Andreas Fyrillas, ... Niccolo Somaschi\n\n### Geometry-enhanced pretraining on interatomic potentials\n\nArticle 05 April 2024\n\nTaoyong Cui, Chenyu Tang, ... Wanli Ouyang\n\n### A fully integrated wearable ultrasound system to monitor deep tissues in\nmoving subjects\n\nArticle 22 May 2023\n\nMuyang Lin, Ziyang Zhang, ... Sheng Xu\n\n## Introduction\n\nSince the Fukushima nuclear accident in 2011 till the recent risk at\nZaporizhzhia nuclear power plant, there is an increasing global need calling\nfor improved radiation detection technology, aiming to achieve high-\nperformance radiation detection mapping with minimum impact on detectors and\nreduced cost. Due to the simultaneous presence of multiple radiation-\ninteraction mechanisms, radiation detection for ionizing radiation is\nconsiderably harder than visible light. The large penetration depth of\nradiation, such as hard X-ray, \u03b3-ray, and neutron, reduces the angular\nsensitivity of detectors and limits the majority of radiation detection\nefforts to focus on counting or spectra acquisition rather than their\ndirectional information. The challenge of acquiring directional radiation\ninformation further triggers additional difficulties in performing source\nlocalization, that to determine the position distributions of radiation\nsources^1,2. In recent years, radiation localization has attracted increased\ninterest with applications such as autonomous nuclear site inspection. Several\nprototypes of system configurations have been proposed including unmanned\nground^2,3,4, aerial^3,5,6,7 and underwater vehicles^8,9. Despite the\nremarkable progress, the information extraction process of the radioactive\nenvironment is still seeking active developments.\n\nIn past decades, several approaches have been proposed for directional\nradiation detection. One approach is the High-Efficiency Multimode Imager\n(HEMI), which can be used to detect and locate \u03b3-ray and X-ray radioactive\nsources^10,11,12,13. A typical HEMI consists of two layers of CdZnTe (CZT)\ndetectors; the first layer has a randomly arranged aperture for coded aperture\nimaging, and the second layer is the conventional co-planar detector grid.\nThis system requires the incident beam to only come from a limited solid angle\nrange to make sure the beam passes through the aperture of the first layer to\ninteract with the second layer. The traditional reconstruction algorithm\nrequires all the incident beams to come within the field of view. The accuracy\nwill be affected if the radiation is incident from another direction\n(especially for near-field radiation). Besides, this system can only\nconditionally detect multiple sources, usually when the sources come from\ndifferent isotopes and can be distinguished by energy. In this scenario, the\ndetection with multiple sources can be reduced to single-source detection by\nonly considering the count of events within an energy range. However, in real-\nworld applications, different sources are not necessarily distinguishable in\nthe energy spectrum. Besides HEMI, another approach for directional radiation\ndetection is realized by using single pad detectors separated by padding\nmaterial^14 i.e., self-shielded method. Radiation sources from different\ndirections and distances can result in different intensity distribution\npatterns over detector arrays. Because of the inaccuracy of the model caused\nby misalignment and manufacturing errors of detector and shielding material,\nit is challenging to extract information from detector data via a traditional\nmethod such as non-linear fitting. Also, the traditional method is often most\nefficient in single source with reduced efficiency in multiple sources. As for\nradiation localization and mapping, inspired by the widespread interest in\nSimultaneous Localization and Mapping (SLAM)^15 techniques, several works\nusing non-directional detectors^6,7 or HEMI^13 for radiation source\nlocalization and mapping have been presented. Recently, active masked designs\nhave been developed, contrasting with traditional coded masks. In these\ndesigns, multiple detector segments shield each other, creating an\nanisotropically sensitive and omnidirectional field of view. For example,\nrecent projects developed the neutron-gamma localization and mapping platform\n(NG-LAMP) system with a 2 \u00d7 2 array of CLLBC (Cs_2LiLa(Br,Cl)_6:Ce)\ndetectors^16; the MiniPRISM system^17,18, which uses a partially-populated 6 \u00d7\n6 \u00d7 4 array of CZT detectors; and an advanced neutron- and gamma-sensitive\nimager using a partially-populated 6 \u00d7 6 \u00d7 4 array of CLLBC detectors^19.\nThere have been similar kinds of high-angular-contrast designs with additional\nhigh-density passive elements^20,21, or more traditional Compton cameras for\nin-field use^22,23,24.\n\nIn this work, we propose a radiation detection framework using a minimal\nnumber of detectors, combining Tetris-shaped detector with inter-pixel\npaddings, along with a deep-neural-network-based detector reading analysis.\nFigure 1 shows the overview of our framework. We demonstrate that detectors\ncomprised of as few as four pixels, augmented by the inter-pixel padding\nmaterial to intentionally increase contrast, could extract directional\ninformation with high accuracy. Moreover, we show that the shapes of the\ndetectors do not have to be limited to a square grid. Inspired by the famous\nvideo game of Tetris, we demonstrate that other shapes from the Tetrominoes\nfamily, in which the geometric shapes are composed of four squares, can have\npotentially higher resolution (Fig. 1a). For each shape of the detector, we\ngenerate the data of the detector\u2019s input from radiation sources using Monte\nCarlo (MC) simulation (Fig. 1b). Figure 1c shows the machine learning model we\ntrained to predict the direction of radiation sources. Using the filter layer\nand the deep U-net convolutional neural networks, we establish the model to\npredict the radiation source direction from the detected signal. As Fig. 1d\nillustrates, we compare the ground-truth label of the radiation source\ndirection (blue) with the predicted direction (brown). By using Wasserstein\ndistance as the loss function (see \u201cMethods\u201d for details), the model can\nachieve high accuracy of direction estimation. As an application of the\ndirectional detector, additional Maximum a Posteriori (MAP) has been\nimplemented to a moving detector so that we can further estimate the spatial\nposition of the radiation sources in both simulations and real-world\nexperiments. Throughout this work, we limit the discussion to 2D since it is\nsufficient in many realistic scenario and leave the 3D discussion for future\nstudies. It\u2019s important to note that the radiation source extends beyond just\ngamma radiation. Each type of radiation necessitates the development of\nspecialized detectors, as the properties of penetration, scattering, and\ndetection mechanisms vary significantly among different radiation sources. For\nneutron localization tasks, significant advancements in neutron localization\nhave been made with the high-efficiency, fast, and high-resolution thermal\nneutron imaging detectors^19,25,26,27. Our work focuses on mapping \u03b3\nradiation. Localization of other radiation source types is expected to share\nsimilar principles, but is dedicated to future works.\n\nFig. 1: Overview of Tetris-inspired radiation mapping with neural networks.\n\na The geometrical setting of the radiation detectors. Instead of using a\ndetector with a large square grid, here we use small 2 \u00d7 2 square and other\nTetromino shapes. Padding material is added between each pixel to increase\ncontrast. b\u2013d The workflow for learning the radiation directional information\nwith Tetris-shaped detector and machine learning. b Monte Carlo simulation is\nperformed to generate the detector readings for various source directions. c\nThe detector\u2019s readouts are embedded to a matrix of filter layers for better\ndistinguishing far-field and near-field scenarios. The embedded data then goes\nthrough a deep U-net. d The predicted direction of radiation sources from the\nU-net (brown) with predicted angular \\\\(\\hat{\\theta }\\\\) is compared to the\nground-truth Monte Carlo simulations (blue) with true angular data \u03b8. The\nprediction loss is calculated by comparing the pairs (\u03b8, \\\\(\\hat{\\theta }\\\\)).\n\nFull size image\n\n## Results\n\n### Directional prediction with static detectors\n\nFirst, we train the machine learning model so that the static detectors can\ndetect the direction from which the radiation comes from. We use OpenMC^28\npackage for MC simulation of the radiation detector receiving the signal from\nan external radiation source (more details in \u201cMethods\u201d Section). We assume\nthat the detector pixels are composed of CZT detectors with pixel size 1 cm \u00d7\n1 cm, slightly larger than the current crystals but still much smaller than\nthe 5 meters of source-detector distance. The inter-pixel padding material is\nchosen to be 1 mm-thick lead empirically, which is thick enough to create\ncontrast and with quite a low photon absorption in the \u03b3-ray range. Throughout\nthis study, we assume that the incident beam energy is \u03b3-ray of 0.5 MeV, which\nis the realistic energy from pair production and comparable to many energy\n\u03b3-decay energy levels. Given the energy resolution from CZT detector,\nradiations with other energies are also expected to be resolvable, even though\nhere we only focus on the directional mapping where only counting matters.\nMore details on the data preparation, normalization, neural network\narchitectures and training procedures are shown in Methods Section. We\nevaluate the prediction accuracy of detectors which comprise with four\ndetector configurations: 2 \u00d7 2 square grid, Tetrominos of S-, J-, T-shapes.\nThe I-shaped Tetris detector array is not presented since it does not show\nperformance good enough for directional mapping. The main results of the\npredicted radiation direction for the four Tetris-inspired detectors are\nillustrated in Fig. 2 and summarized in Table 1. While the S-shape detector\nworked with the smallest prediction followed by 2 \u00d7 2 square, J- and T-shapes,\nall of the four types of detector could work enough to know the direction of\nthe radiation source with about 1-deg(\u00b0) accuracy.\n\nFig. 2: Directional radiation detection with prediction with static Tetris\ndetectors.\n\nSelected outcomes from source direction predictions with detectors of simple\nconfigurations are displayed. Each figure includes the signal input employed\nfor the input from the detector and the polar coordinates showing the\ndirectional predictions. The blue and brown curves represent the ground truth\nand prediction, respectively. We show results using the detector\nconfigurations of (a, b) a 2 \u00d7 2 square, (c, d) S-shape, (e, f) J-shape, and\n(g, h) T-shape. For each detector type, we display (a, c, e, g) the scenarios\ndemonstrating the largest loss for each detector shape in test data,\nhighlighting challenging prediction situations. b, d, f, h The scenarios with\nthe smallest loss in test data, showcasing relatively successful prediction\ncases.\n\nFull size image\n\nTable 1 Ablation on neural network backbones with different scenarios 2 \u00d7 2\nsquare grid and three types of Tetrominos, evaluated by the Wasserstein\ndistance of angular distributions\n\nFull size table\n\nFigure 2 shows detector readouts and typical angular distributions predicted\nby neural networks in polar plots. The blue and brown colors represent the\nground truth from MC and the neural network prediction, respectively. Figure\n2a, b are the 2 \u00d7 2 square-grid detector, showing a predictive power of the\nradiation with the largest and smallest prediction errors. The performance of\nother Tetris-inspired detector shapes, including S-, L- and T-shapes, are\nshown in Fig. 2c\u2013h. By comparing different Tetris shapes, we can see that\nthere is a generic trend that S-shaped Tetris can show the best performance\nwhile T-shaped Tetris is the least accurate. This can be intuitively\nunderstood from a symmetry analysis. For instance, for incident radiation from\nthe \u201cnorth\u201d with \u03b8 = 0\u00b0, the left and right pixels and padding materials in\nthe T-shape receive identical signals from radiation sources, which reduces\nthe number of effective pixels and padding materials. On the other hand, the\nS-shaped detector possesses pixels each of which receive non-equivalent\nsignals from radiation sources of any direction, presenting lower prediction\naccuracy than the square detector. Although the square Tetris in Fig. 2a, b\nhas higher symmetry than others, it also contains four pieces of inter-pixel\npadding materials, in contrast to other cases with three pieces. Such analysis\nmay also apply to the I-shaped detector array, given its high symmetry and\nless effective pixels. Figure S4 provides the detailed analysis of the\nprediction accuracy with respect to the radiation source directions. In\nSupplementary Note 3, we present further analysis of directional prediction\nwith the Tetris-inspired detectors. Figure S5 shows the effect of the\nradiation source energy, arguing the importance of optimizing the radiation\nsource energy for generating training dataset for practical application of the\ndetector. Also, we proposed our proposed model architecture with two filter\nlayers is effective in diverse scenarios by comparing it with the benchmark\nmodel of a single filter layer. Figure S6 and Table S3 show that the single-\nfilter layer model has the capability to predict the directions of two\nradiation sources simultaneously. However, the two-filter layer model offers\ncould accommodate diverse scenarios, as explained in Table S4. Furthermore, we\nsurveyed the robustness of our directional prediction against the background\nnoise effect. Figure S7 presented that the S-shaped detector performs the best\nif there is no noisy background, while the 2 \u00d7 2 detector had the highest\nrobustness against the added Gaussian noise.\n\n### Positional prediction with moving detectors and maximum a posteriori (MAP)\nestimation\n\nIn real-world applications of radiation mapping, it would be highly desirable\nto go beyond the directional information and also determine the position of\nthe radiation source. Here, a method based on Maximum A Posteriori (MAP)\nestimation is proposed in order to generate the guessed distribution of\nradiations through the motion of detectors. The workflow is as follows: first,\nthe detector readout is simulated by MC given the detector\u2019s initial position\nand orientation, just as the case for the static detector. Second, the\ndetector begins to move in a circular motion. The schematics are shown in Fig.\n3a. It is worthwhile mentioning that the particular detector face that aligns\nwith the detector\u2019s moving direction does not matter much since the detector\nfacing any direction is already a valid directional detector that is sensitive\nto radiations coming from all directions. In other words, even if the detector\nis rotated intentionally or accidentally during the circular motion, the final\nresults are still robust (Figs. S15\u2013S20 and Supplementary Movies 7\u201310 in\nSupplementary Note 6). Third, at each instantaneous timestamp during the\ndetector motion, the predicted source direction is calculated based on the\ndeep U-net model, just like the static detector case. Finally, the radiation\nsource location is estimated via MAP based on the series of neural-network-\ninferred detector direction data at different detector positions. In an ideal\ncase for one single isotropic radiation source, as few as two detector spatial\npositions are just enough to locate the source position (as the intersection\nof the two rays along the directions in the two detector positions) and the\ncircular motion and MAP are implemented for more complicated radiation profile\nmapping. To improve the performance, we set a threshold for visualizing the\nradiation map. Our radiation maps are normalized by the highest probability of\nthe presence of the radiation sources in the area of interest. We set the\nthreshold as 0.3 and made every value on the area of interest that is lower\nthan this threshold zero. This procedure enables us to visualize the mapping\nresult clearly.\n\nFig. 3: Radiation mapping and position determination with an S-shape Tetris-\ninspired detector.\n\na By acquiring detector readings at each spatial position during the circular\nmotion, the position of the radiation can be gradually optimized through MAP.\nb\u2013d The process to map the radiation source at a few representative times at t\n= 10, 30, and 60 s, respectively. The \u201c\u00d7\u201d symbol on the maps shows the ground-\ntruth location of the radiation source. The areas colored with intense red\nindicate a high probability of where the radiation source is located. The\npurple arrows indicate the front side of the radiation detector. e\u2013j The\ndetector\u2019s input signals and the predicted directions of the radiation sources\nat time t = 10, 20, 30, 40, 50, and 60 s. Both the input signal and the curves\nof the polar coordinates are visualized in the detector frame. The top side of\nthe detector represents the front side. Check the radiation mapping process in\nSupplementary Movie 1.\n\nFull size image\n\nFigure 3b\u2013j shows the dynamical process of radiation mapping and position\ndetermination using the S-shaped detector. The detector geometry is the same\nas before, and the radius of motion is chosen randomly distributed from 0.5 m\nto 5 m. Figure 3b\u2013d shows the inferred radiation mappings at three different\ntimestamps t = 10, 30, 60 s at the beginning, half-circle, and close to the\nend of the circular motion. The ground-truth location of the radiation source\nis shown as the black cross in all three figures. At the early t = 10 s, there\nis not sufficient information for MAP to estimate the radiation position, and\nthe estimation (red lines in Fig. 3b) has a ray shape that acts more like\ndirectional mapping. After 30 s, the MAP estimation is improved, though the\nestimated radiation is located at a broader spatial area rather than the\nground truth. Finally, the detector could complete the mapping process with\nsufficient accuracy to point out the position of the radiation source (Fig.\n3d). The detector\u2019s readouts and the predicted directions at each timestamp (t\n= 10, 20, 30, 40, 50, and 60 s) are illustrated as Fig. 3e\u2013j. The detailed\nresults with other Tetris-inspired detectors are shown in Supplementary Note\n4. Figures S9\u2013S11 present the moving detector and radiation mapping using the\ndetectors of 2 \u00d7 2 square, J-shape and T-shape, respectively. Supplementary\nMovies 2\u20134 visualize these mapping processes at each timestamp. The actual and\npredicted relative angle are plotted throughout the observed time in Fig. S12.\n\nWhen performing a realistic radiation mapping, the area of interest may\ncontain multiple radiation sources, which increases the level of difficulties\nof radiation mapping. To tackle this challenge, we further study the radiation\ndistribution map, which includes multiple radiation sources (Fig. 4). We can\nsee good agreement can be achieved for two radiation sources. However, we\nwould like to point out that more detector pixels such as 10 \u00d7 10 (Fig. 4a) or\n5 \u00d7 5 (Fig. 4b) grids are used since the 2 \u00d7 2 square-grid detector does not\nshow adequate performance unless the restriction of fixed distances between\nthe detector and the radiation sources, as shown in Fig. S6. Figures S13 and\nS14 in Supplementary Note 5 present the intermediate process of radiation\nmapping with the square detectors of 10 \u00d7 10 and 5 \u00d7 5 configurations,\nrespectively.\n\nFig. 4: Radiation mapping of two radiation sources with a moving detector.\n\nTwo radiation sources are placed in the space (shown as the two black crosses\nof \u201c\u00d7''). The detector is moving in a circular motion around the sources (blue\ncircles). We use the detector of 10 \u00d7 10 grid (in a) and 5 \u00d7 5 grid (in b).\nCheck the radiation mapping process in Supplementary Movies 5 and 6.\n\nFull size image\n\n### Experimental validation of radiation mapping with a 4-pixel detector\n\nIn the preceding sections, we demonstrated the efficacy of our machine-\nlearning approach in accurately locating radiation sources in 2D space using\nMC simulation data. To validate the practical utility of our method in the\nfield of radiation measurement, it is essential to assess its performance in\nreal-world experimental scenarios.\n\nWe conducted a comprehensive experiment to map the location of a radiation\nsource within a real-world environment. As Fig. 5a shows the experimental\nschematics, the measurement involved positioning a Cs-137 radiation source at\ncoordinates (5.0, 0.0, 0.0), while the experimental team kept the source\nposition secret until radiation mapping algorithms predicted it. We deployed a\nradiation detector configured in a 2 \u00d7 2 square layout and moved the detector\naround the area near the radiation source. The detector outputs the radiation\nabsorption by each crystal (pixel) at regular intervals of 0.5 s. We employed\na signal smoothing technique to reduce measurement fluctuations. \u201cMethods\u201d and\nSupplementary Note 7 explain further details regarding the experimental setup\nand data analysis, including a conventional non-neural-network approach for\nradiation source mapping.\n\nFig. 5: Experimental setup and radiation mapping with experimental measurement\ndata (top view).\n\na Annotated photograph of the measurement setup. The red and green arrows show\nthe approximate x- and y-axes of the detector coordinate, and the 171 \u03bcCi\nCs-137 source is shown on the corner of the concrete ledge about 80 cm above\nthe sidewalk level. Note that the radiation source was deliberately positioned\nat coordinates (5.0, 0.0, 0.0), and the data analysis remained intentionally\nblinded to the true source location until they made a prediction. b Top-down\nview of the GPSL reconstruction z-scores of the measurement. The thin bands of\nblack LiDAR points appearing around (0.0, 0.0, 0.0) are artifacts from the\nsystem\u2019s initial static dwell. c\u2013f The progression of radiation source mapping\nat representative time intervals of t = 0, 14, 28, 42 s, respectively. The\ngray point clouds in the diagrams represent the surrounding environment of our\nexperiment. The symbol \u201c\u00d7\u201d designates the ground-truth location of the\nradiation source. The black dot on the maps indicates the position of the\nradiation detector. We visualize the left (y) and front (x) axes of the\ndetector with green and red arrows, respectively. The black solid line\nindicates the trajectory of the detector. Check the radiation mapping process\nin Supplementary Movie 11.\n\nFull size image\n\nAs an existing analysis method, we demonstrated the non-ML gridded point\nsource likelihood (GPSL) reconstruction method^7 for comparison. Figure 5b\nshows a top-down view of the measurement and GPSL reconstruction for the\nmeasurement. The gray points are the LiDAR point cloud of the scanned area,\nand the red, green, and blue lines show the detector\u2019s x, y, and z axes at\neach 0.5 s timestamp. The path between the axes is colorized by gross counts\n(qualitatively) from low (cyan) to high (magenta). The color bar denotes the\nlikelihood contours of z-scores up to 5\u03c3 that the given 10 cm pixel contains a\npoint source. The most likely point source position is highlighted by the\nblack dashed crosshair, while the red dashed crosshair shows the actual source\nposition. With the limited approach to the source afforded by the circular\ndetector trajectory, there is a slight 0.75 m error in the reconstructed\nposition, but the activity estimate closely matches the actual value of 170.8\n\u03bcCi.\n\nIn Fig. 5c\u2013f, we present the results of our MAP analysis applied to radiation\nmapping with the 4-pixel detector. The maps depict probabilities of holding a\nradiation source. The area denoted by intense red shading represents the\nhigher probability, which precisely converges around the ground-truth position\nof the radiation source marked by \u201c\u00d7.\u201d This convergence underscores that our\nneural network, equipped for directional prediction and MAP analysis,\neffectively approximated the actual location of the radiation source with\nequivalent quality to the GPSL approach. We provide additional images offering\nboth top-down (z-axis direction) and aerial perspectives in Figs. S21 and S22\nof Supplementary Note 7 for a comprehensive view of the mapping process at\nvarious time intervals. In Supplementary Movie 11, we present the measured\nsignal at each timestamp and the process by which the moving detector maps the\nradiation in the experimental scenario.\n\n## Discussion\n\nThe conventional detector configuration has a grid structure vertically facing\nthe source of detection, where each detector pixel receives the radiation\nsignal with a slightly different solid angle. In this work, we propose an\nalternative detector configuration with a few features. First, the detector\ngrid is placed horizontally within the plane instead of vertically facing the\nsource. Second, additional thin padding layers are padded between detector\npixels, i.e., the contrast between pixels is not only created by incident\nangles but also enhanced by padding layers that are good absorption layers of\nradiation. Third, machine learning algorithms are implemented to analyze the\ndetector reading, demonstrating great promise to reduce the need for detector\npixel numbers and thereby reduce the cost of fabrication and deployment.\nFourth, non-conventional Tetris-shaped detector geometry is proposed beyond\nthe square grid, which can lead to more efficient use of pixels with improved\nresolution, particularly for the S-shaped Tetris detector. Finally, we\ndemonstrate the possibility of locating the positions of radiation sources in\na moving detector scheme through MAP. Experimental validation could further\nprove the capability of our machine learning approach for locating radiation\nsources in the real-world scenario.\n\nDespite these initial successes, we believe the configuration proposed in this\nwork is still in its infancy. Several refined works are foreseeable.\nParticularly, although the 2D configuration can represent several realistic\nscenarios, such as radiation sources are far away from the detector but still\nclose to ground level, it would still be an interesting problem to study 3D\nconfiguration, possibly with 3D detectors like Rubic-shaped detector cubes.\nMoreover, several improvements, such as moving radiation sources and energy\nspectra of radiation, may be feasible with a more advanced approach like\nreinforcement learning. Our work represents one step that leverages the\ndetector pixels and shapes with machine learning toward radiation detection\nwith reduced complexity and cost.\n\n## Methods\n\n### Monte Carlo simulation of static detector and data representation\n\nThe training data, in other words, the intensity measured by each detectors is\nsimulated by MC Simulation based on the principle of radiation-matter\ninteraction. We used an existing MC simulation package called OpenMC^28.\nOpenMC incorporates effects like Compton scattering and pair production,\nenabling simulations to accurately model radiation interactions in realistic\nscenarios. Some representative results of the detector arrays is shown in Fig.\n2. For the sake of simplicity, we temporarily assume the radiation source and\nthe detector arrays are in the same plane. In the MC simulation, first we\ndefine the geometry of the detector. Schematic figures of detectors arrays are\nshown in Fig. 1. The adjacent detectors (yellow) are separated by attenuation\nmaterials (black), which forms the detectors\u2019 configuration like lattices. We\nset the distance d (cm) between the center of the detector and the radiation\nsource. The direction of the radiation source is defined as an angle \u03b8, which\nis defined in clockwise direction from the front side of the detector. When we\ngenerate training data, we selected d and \u03b8 at random (d \u2208 [20, 500], \u03b8 \u2208 [0,\n2\u03c0)) so that the neural network could get feature from radiation sources of\nvarious distances and directions. The distribution of the radiation source\npositions is shown in Fig. S1. After MC simulation was completed, the\ndetector\u2019s readouts are represented as the matrix of (h \u00d7 w), where h and w\nare detectors\u2019 dimensions of heights and width respectively. For the square\ndetector comprised of four detector panels, the data of 2 \u00d7 2 matrix was\nnormalized so that the mean and the standard deviation are 0 and 1,\nrespectively. For the detectors of Tetromino-shapes, the detectors\u2019 readouts\nare represented as 2 \u00d7 3 matrices. Since two sites of the matrices\u2019 6 elements\nare vacant, we filled them with zero and did normalization in the same way as\nthe square detectors. We followed the same MC simulation method as above to\ngenerate the 64 filter layers, which we explain in more detail in this\nsection. All other parameters used in MC simulations are shown in Table S1.\n\nThe dataset D is in the form of\n\\\\({\\\\{{{{{{{{{\\bf{x}}}}}}}}}^{(i)},{{{{{{{{\\bf{y}}}}}}}}}^{(i)}\\\\}}_{i\\in\n[1,{N}_{1}]}\\\\), where N_1 is the size of the dataset.\n\\\\({{{{{{{{\\bf{x}}}}}}}}}^{(i)}\\in {{\\mathbb{R}}}^{h\\times w}\\\\) is the\nnormalized readouts of the detector arrays h, w denotes the number of rows and\ncolumns of the detector arrays, respectively. For example, h = w = 2 for 2 \u00d7 2\nsquare detector, h = 2, w = 3 for Tetromino-shape detector.\n\\\\({{{{{{{{\\bf{y}}}}}}}}}^{(i)}\\in {{\\mathbb{R}}}^{{N}_{a}}\\\\) is the angular\ndistribution of the incident radiation, N_a is the number of sectors that are\nused to separate [0, 2\u03c0). Each element in y^(i) represents the ratio of\nincident radiation intensity received from the direction of this sector to the\ntotal incident radiation intensity. For the point sources, the angular\ndistribution of the radiation source is represented by the following method.\nFor an angular distribution y contributed by multiple point sources, let y_j\nrepresent the angular distribution contributed by the jth point source. The\nkth element of y_j is defined by:\n\n$${y}_{jk}=\\left\\\\{\\begin{array}{ll}0,\\hfill\\quad\n&\\,{{\\mbox{if}}}\\,\\,\\left\\vert {\\theta }_{j}-\\frac{2\\pi }{N}(k-1)\\right\\vert\n\\ge \\frac{2\\pi }{N}\\\\\\ \\frac{\\left\\vert {\\theta }_{j}-\\frac{2\\pi\n}{N}(k-1)\\right\\vert }{\\frac{2\\pi }{N}},\\quad\n&\\,{{\\mbox{else}}}\\hfill\\,\\end{array}\\right.$$\n\n(1)\n\nWe also have:\n\n$${{{{{{{\\bf{y}}}}}}}}=\\mathop{\\sum}\\limits_{j}\\frac{{I}_{j}}{{I}_{0}}{{{{{{{{\\bf{y}}}}}}}}}_{j}$$\n\n(2)\n\nwhere \u03b8_j denotes the incident angle of the jth radiation source, I_j denotes\nthe total incident intensity revived from the jth radiation source, I_0 =\n\u03a3_jI_j s the total incident intensity revived from all radiation sources. By\nusing this representation, we are able to accurately represent the incident\ndirection of a point source with an arbitrary angle, with a discretized angle\ninterval. In the experiments, [0, 2\u03c0) is separated in to N_a = 64 sectors.\nFigure 2 illustrates this representation by a pie chart.\n\n### Deep neural network architecture\n\nIn order to extract the global patterns of the input data, a set of global\nfilters is designed. We obtain several filters based on very high-quality\nsimulations in some representative cases, including far-field incident (the\nradiation source is located at a far distance compared to the size of the\ndetector arrays) and near-filed (the radiation source is located at a close\ndistance) incident at different directions. As an example, near-field filters\nof the S-shape detector are shown in Fig. S2. Each filter has the size of (h \u00d7\nw), which is set same as that of the training data. The weight of each unit is\ngiven by the readout of each single pad detector in the simulation. The output\nof this layer is given by:\n\n$${Z}_{mk}=\\mathop{\\sum}\\limits_{i}\\mathop{\\sum}\\limits_{j}{x}_{ij}{w}_{m}{F}_{mkij}+{b}_{mk}$$\n\n(3)\n\nwhere Z_mk is the kth element of the output array at channel m \u2208 {1, 2}.\nChannel 1 and 2 correspond to the far-field and near-field filters\nrespectively. x_ij denotes the input array at pixel i, j, F_mkij denotes the\n(i, j) element of the global filter obtained in the case that incident\nradiation from the kth sector, in far-field (m = 1) or near-field (m = 2)\nscenario. w_m denotes a channel-wise normalization weight, and b_mk denotes\nthe bias for this global filter. During training, the weights of the global\nfilter are initialized with the far-field and near-field filters that we\nobtained from the high-quality simulations. The weights are slightly fine-\ntuned with a learning rate lower than the learning rate of the other layer of\nthe network, while the bias for each filter is trained with the same learning\nrate as the other layers. The filter layer is followed by an Exponential\nLinear Unit (ELU) activation function^29. The output of the global filtering\nlayer embeds the directional information corresponding to the direction of the\nfilter channel. It is then fed into the U-shape network to extract the\ndirectional information.\n\nIn the neural network, the input data is normalized (h \u00d7 w) detectors readout.\nHowever, it is essentially different from images captured by cameras. For the\nprocessing of images which is measured from visible light, convolution neural\nnetworks (CNNs) are widely used^30. A convolution layer is used for extracting\nfeatures that are presented as localized patterns. However, due to the\npenetration properties of several kinds of radiation, such features are\npresented as global patterns, which is different from the imaging of visible\nlight. Therefore, an updated architecture is designed for this purpose; the\ninput data is followed by a global filtering layer with the shape (2, 64, h,\nw) in order to extract the global pattern. The output of this layer conveys\nthe directional information with a size of (2, 64), which corresponds to the\nfinal output, i.e., the estimated angular distribution, with a size of (1,\n64). In order to perform a pixel-to-pixel prediction of the angular\ndistribution, a U-shape fully convolutional architecture which is similar to\nU-Net^31 is then utilized as Fig. 1b\u2013d shows. Noticed that the U-Net\narchitecture was originally developed for image segmentation^31. However, here\nthe output is a 1D array, and the input is viewed as a 1D array with two\nchannels. Thus, we accordingly set the dimension of the U-Net, as is shown in\nFig. S3. Finally, the output of the final layer feeds into a softmax layer for\nnormalization.\n\nIn order to represent the distributional similarity between the predicted and\ntarget distribution, Wasserstein distance is proposed to be used as the loss\nfunction. It is a distance function on a given metric space between two\nprobability distributions. As this metric is an analogy of the minimum cost\nrequired to move a pile of earth into the other, it is also known as the earth\nmover\u2019s distance^32,33,34. The Wasserstein loss function is given by:\n\n$$W=\\mathop{\\min }\\limits_{\\pi (i,j)}\\mathop{\\sum }\\limits_{i}^{n}\\mathop{\\sum\n}\\limits_{j}^{n}\\pi (i,j)C(i,j)$$\n\n(4)\n\n$$\\begin{array}{rrr}\\,{{\\mbox{subject to}}}\\,\\quad \\pi (i,j)\\ge 0,&&\\forall\ni,j\\in [1,N]\\\\\\ \\mathop{\\sum}\\limits_{j}\\pi (i,j)\\le {y}_{i},&&\\forall i\\in\n[1,N]\\\\\\ \\mathop{\\sum}\\limits_{i}\\pi (i,j)\\le {\\hat{y}}_{j},&&\\forall j\\in\n[1,N]\\\\\\ \\mathop{\\sum}\\limits_{i}\\mathop{\\sum}\\limits_{j}\\pi\n(i,j)=1&&\\end{array}$$\n\n(5)\n\nwhere \u03c0(i, j) is the transport policy which represents the mass to be\ntransferred from state i to state j, y_i is the ground truth of the normalized\nangular distribution, \\\\(\\hat{{y}_{i}}\\\\) is the estimated angular\ndistribution. C(i, j) is the cost matrix representing the cost of moving unit\nmass from state i to j. Our work is in a cyclic case and uses the following\nform:\n\n$$C(i,j)={\\min (| i-j|,| \\, j+n-i|,| i+n-j| )}^{l}$$\n\n(6)\n\nAn algorithm is developed to calculate the cyclic Wasserstein distance, as is\nshown in Algorithm 1. Particularly, the cyclic case is unrolled into an\nordered case. The ring is split into a line at n different units and obtain n\ndifferent distributions. The cost matrix in the cyclic and ordered cases. The\nWasserstein distance could be computed in closed form^33,35:\n\n$$W(p,t)={\\left(\\frac{1}{n}\\right)}^{\\frac{1}{l}}{\\parallel\nCDF(p)-CDF(t)\\parallel }_{l}$$\n\n(7)\n\nWhere CDF(\u22c5) calculates the cumulative distribution of its input. Following\nthis formula, a decycling algorithm is developed to calculate the Wasserstein\ndistance with a cyclic cost. The algorithm is shown below:\n\n### Algorithm 1\n\nCyclic Wasserstein Distance\n\nIt could be numerically verified that this algorithm enables exact calculation\nof 1st (l = 1) Wasserstein distance for the cyclic Wasserstein distance, given\narbitrary distribution. This algorithm is differentiable and enables us to\noptimize the objective through back-propagation. As for evaluation in the\nexperiments, we use 1st Wasserstein distance which can directly represent the\nangle difference of the estimated and real directions. In the training\nprocess, we use the above 2nd (l = 2) Wasserstein distance as a loss function\nsince it usually converges faster with gradient descent-based optimization\nmethods, compared to the 1st Wasserstein distance^33,36.\n\nIn the proposed model, the network is trained using Adam^37 with a learning\nrate of 0.001 for all parameters in the neural network except for the weights\nof the global filtering layer, whose learning rate is set to 3 \u00d7 10^\u22125. The\ntraining batch for each step is randomly selected from the training set which\nis based on several pristine simulation result set D^train on one radiation\nsource. All models randomly split the data into 90% training (2700 data) and\n10% testing (300 data) sets. Furthermore, we trained our models with a 5-fold\ncross-validation scheme. We summarize the parameters for training the neural\nnetwork for predicting the directions of one or two radiation sources in Table\nS2.\n\n### Radiation source mapping with maximum a posteriori (MAP) estimation\n\nWe set up a radiation mapping problem by considering the case that there is\none point source in the environment. This task could be extended to a\nSimultaneous Localization and Mapping (SLAM) problem^15. The directional\nradiation detector could be viewed as a kind of sensor that could only obtain\ndirectional information, and a radiation source could be viewed as a\nparticular landmark that could only be measured by this kind of detector. We\nshow that by treating the directional radiation detector as a sensor with only\ndirectional resolution, it could be easily integrated into the MAP\noptimization framework and it enables source localization. Details of how to\nintegrate the directional radiation detector into the MAP framework are\npresented in Fig. S8.\n\nHere, a method based on Maximum a Posteriori (MAP) Estimation is proposed in\norder to generate the radiation distribution map. In addition, here, we assume\nthat the carrier for the detector has already localized itself and is only\nrequired to build the radiation map. The map is discretized into a mesh with\nN_m square pixels. Let \\\\(c\\in {{\\mathbb{R}}}^{{N}_{m}}\\\\) denote the\nradiation concentration at each pixel. It could be assumed that the radiation\nis uniformly generated from the pixel. The measurements result z_t = I_0y_t\ndenotes the incident radiation intensity coming from different directions at\ntime t. It could be assumed that the measurement probability p(z_t\u2223c) is\nlinear in its arguments, with added Gaussian noise:\n\n$${{{{{{{{\\bf{z}}}}}}}}}_{t}={{{{{{{{\\bf{M}}}}}}}}}_{t}{{{{{{{\\bf{c}}}}}}}}+{{{{{{{\\boldsymbol{\\delta\n}}}}}}}}$$\n\n(8)\n\nwhere \\\\(\\delta \\sim N\\left(0,{\\Sigma }_{\\delta }\\right)\\\\) describes the\nmeasurement noise, \\\\({{{{{{{{\\bf{M}}}}}}}}}_{t}\\in {{\\mathbb{R}}}^{N\\times\n{N}_{m}}\\\\) denotes the observation matrix at time t. Note that in our study,\nwe treat gamma measurements as continuous real numbers with Gaussian noise,\nwhich is appropriate for scenarios where the sample size is sufficiently\nlarge, and the mean count rate is not significantly low. The central limit\ntheorem ensures that for a significant sample size, the Poisson distribution,\nwhich describes the discrete nature of event counts, tends to approximate a\nGaussian distribution. As such, our choice of Gaussian distribution provides a\nreasonable approximation for the behavior of directional radiation detectors\nunder the conditions of our experiments, where the counts are reasonably\nlarge, allowing us to accurately model the measurement uncertainties.\nConsidering the contribution of one pixel to one direction sector of the\ndetector, only the overlapped area can contribute to the sector, as is shown\nin Fig. S8, and the intensity is proportional to the overlapped area. Besides,\nthe intensity is inversely proportional to the square of the distance between\nthe detector and the source. Therefore, the element of M_t, or in other words\nthe intensity contribution of the ith pixel to the jth directional sector of\nthe detector at time t can be written as:\n\n$${M}_{tij}=\\frac{{A}_{tij}}{{{r}_{ti}}^{2}}$$\n\n(9)\n\nwhere A_tij denotes the area of the overlapped region of the ith pixel and the\njth sector at time t (blue area in Fig. S8), r_ti denotes the distance between\nthe detector and the center of the pixel. According to Bayes\u2019 rule, we have:\n\n$$p({{{{{{{\\bf{c}}}}}}}}|\n{{{{{{{{\\bf{z}}}}}}}}}_{1},{{{{{{{{\\bf{z}}}}}}}}}_{2},\\ldots,{{{{{{{{\\bf{z}}}}}}}}}_{t})\\,\n=\\,\n\\frac{p({{{{{{{{\\bf{z}}}}}}}}}_{1},{{{{{{{{\\bf{z}}}}}}}}}_{2},\\ldots,{{{{{{{{\\bf{z}}}}}}}}}_{t}|\n{{{{{{{\\bf{c}}}}}}}})p({{{{{{{\\bf{c}}}}}}}})}{p({{{{{{{{\\bf{z}}}}}}}}}_{1},{{{{{{{{\\bf{z}}}}}}}}}_{2},\\ldots,{{{{{{{{\\bf{z}}}}}}}}}_{t})}\\\\\\\n\\, \\propto \\,\np({{{{{{{{\\bf{z}}}}}}}}}_{1},{{{{{{{{\\bf{z}}}}}}}}}_{2},\\ldots,{{{{{{{{\\bf{z}}}}}}}}}_{t}|\nc)p(c)\\\\\\ \\,=\\, p({{{{{{{\\bf{c}}}}}}}})\\mathop{\\prod\n}\\limits_{i=1}^{t}p({{{{{{{{\\bf{z}}}}}}}}}_{i}| {{{{{{{\\bf{c}}}}}}}})$$\n\n(10)\n\nHere, we assume that measurements at different times are conditionally\nindependent given c. As we are trying to find c that maximizes p(c\u2223z_1, z_2,\n..., z_t), the p(z_1, z_2, ..., z_t) term could be ignored as it is\nindependent of c. It could be assumed that the prior term p(c) = N(0, \u03b5I) is a\nGaussian distribution. Then following the Maximum a Posteriori (MAP)\nestimation, we have:\n\n$$\\mathop{{{{{\\rm{argmax}}}}}}\\limits_{{{{{{{{\\bf{c}}}}}}}}}\\,p({{{{{{{\\bf{c}}}}}}}}|\n{{{{{{{{\\bf{z}}}}}}}}}_{1},{{{{{{{{\\bf{z}}}}}}}}}_{2},\\ldots,{{{{{{{{\\bf{z}}}}}}}}}_{t})\\,\n=\\,\n\\mathop{{{{{\\rm{argmax}}}}}}\\limits_{{{{{{{{\\bf{c}}}}}}}}}\\mathop{\\sum}\\limits_{t}\\ln\np({{{{{{{{\\bf{z}}}}}}}}}_{t}| {{{{{{{\\bf{c}}}}}}}})+\\ln\np({{{{{{{\\bf{c}}}}}}}})\\\\\\ \\,=\\,\n\\mathop{{{{{\\rm{argmin}}}}}}\\limits_{{{{{{{{\\bf{c}}}}}}}}}\\mathop{\\sum}\\limits_{t}\\parallel\n{{{{{{{{\\boldsymbol{M}}}}}}}}}_{t}{{{{{{{\\bf{c}}}}}}}}-{{{{{{{{\\bf{z}}}}}}}}}_{t}{\\parallel\n}_{{{{{{{{{\\boldsymbol{\\Sigma }}}}}}}}}_{{{{{{{{\\boldsymbol{\\delta\n}}}}}}}}}}^{2}+\\frac{1}{{\\varepsilon }^{2}}{\\parallel\n{{{{{{{\\bf{c}}}}}}}}\\parallel }_{2}^{2}\\\\\\ $$\n\n(11)\n\nTherefore, the radiation concentration distribution could be obtained by\nsolving the optimization problem:\n\n$$\\mathop{\\min }\\limits_{{{{{{{{\\boldsymbol{c}}}}}}}}}\\,\\,\\mathop{\\sum}\\limits_{t}\\parallel | {{{{{{{{\\boldsymbol{M}}}}}}}}}_{t}{{{{{{{\\boldsymbol{c}}}}}}}}-{{{{{{{{\\boldsymbol{z}}}}}}}}}_{t}| {| }_{{{{{{{{{\\boldsymbol{\\Sigma }}}}}}}}}_{{{{{{{{\\boldsymbol{\\delta }}}}}}}}}}^{2}+\\frac{1}{{\\varepsilon }^{2}}| | {{{{{{{\\boldsymbol{c}}}}}}}}| {| }_{2}^{2}\\quad \\,{{\\mbox{subject to}}}\\,\\,\\,{c}_{i}\\ge 0,\\,\\,\\forall i\\in [0,{N}_{m}]$$\n\n(12)\n\nwhere \\\\(\\frac{1}{{\\varepsilon }^{2}}\\parallel {{{{{{{\\bf{c}}}}}}}}{\\parallel\n}_{2}^{2}\\\\) term could be viewed as a regularization term. If we do not have\nmuch information regarding the prior distribution, \u03b5 will be a large number.\nThis term will penalize large concentration if the measuring data is\ninadequate to determine the concentration (i.e., the area is not fully\nexplored and caused very small M_tij). In practice, \u03b5 could be tuned by\nutilizing differentiable convex optimization layers^38, in which the\noptimization problem could be viewed as a layer within the neural network, and\nerror back-propagation is enabled through implicit differentiation, given\npredicted and ground truth data. In our demonstration case, we simply set\n\\\\(\\frac{1}{{\\varepsilon }^{2}}=0.1\\\\) such that the regularization term is\nrelatively small.\n\n### Experimental setup of real-world radiation mapping and post-process for\nMAP analysis\n\nThe system comprises a 2 \u00d7 2 array of 1 \u00d7 1 \u00d7 2\u201d CLLBC (Cs_2LiLa(Br,Cl)_6:Ce)\ngamma/neutron detectors separated by a polyethylene cross. The detector is\nequipped with a Localization and Mapping Platform (LAMP) sensor suite used to\nmap the 3D environment and determine the detector pose (position and\norientation) within that environment, and the demonstration measurements were\nmade with Lawrence Berkeley National Laboratory\u2019s Neutron Gamma LAMP (NG-LAMP)\nradiation mapping system^39. A 171 \u03bcCi Cs-137 check source was placed on a\nconcrete ledge in an outdoor environment, and the detector system was used to\nmake free-moving measurements of the source. The detector was hand-carried in\na circular pattern of about 2 m radius around a point 5 m away from the source\nlocation for up to 45 s, completing almost 2.5 loops. Throughout the\nmeasurement, the detector orientation was kept almost fixed with respect to\nthe environment. The CLLBC crystals were kept at a height close to that of the\nradiation source during the entire measurement duration. The listmode\nradiation data in an energy region of interest (ROI) of [550, 800] keV and the\ndetector pose determined by NG-LAMP\u2019s contextual sensor suite were then\ninterpolated to a 0.5-s time binning. We note that these real-world radiation\nmeasurements placed the source outside the circular detector trajectory to\nmodel a realistic source-search scenario closely.\n\nTo enhance the quality of measurement data for analysis, we applied a series\nof post-processing steps to the measured data. First, the location of the\n661.7 keV Cs-137 photopeak in each crystal had drifted to 690\u2013700 keV,\nnecessitating a manual, multiplicative gain correction for each crystal. To\navoid any possible energy aliasing from this gain correction, the corrected\nenergy values were blurred by a Gaussian kernel of standard deviation 1 keV,\nmuch smaller than the width of the photopeak (10 keV). Furthermore, other\npost-processing steps were applied to the contextual data to streamline the\nanalysis. The light detection and ranging (LiDAR) point clouds and global\ncoordinate frames were more precisely aligned to a single coordinate frame\nusing the Iterative Closest Point (ICP) algorithm in Open3D^40,41. Moreover,\nthe initial and final parts of the measurements where the system was walked\nto/from its intended measurement position(s) and used to perform a dedicated\nLiDAR scan of the area were cut from the radiation mapping analysis. The\ntrajectory and radiation data were cut here, but the contextual LiDAR point\nclouds were not.\n\nAs an existing analysis method for comparative analysis, We demonstrated the\nnon-machine-learning gridded point source likelihood (GPSL) reconstruction\nmethod^7. Using quantitative response functions, GPSL computes the best-fit\nsource activity for every potential source point in the imaging space and\nselects the source point with the maximum likelihood^16. As in the neural\nnetwork analysis, reconstructions were computed for the 2D plane level with\nthe actual source height, using an energy region of interest (ROI) of 661.7 \u00b1\n80 keV.\n\nWe conducted radiation mapping to validate that our neural networks and MAP\nare applicable to the radiation measurement in a real-world scenario. As\ndetailed below, we first pre-processed experimental data as the inputs of our\nanalysis. At each position of the 91 timestamps through 45-s measurements, the\n2 \u00d7 2 square detector acquired measurement data as a matrix of dimensions (4,\n84). These measurements corresponded to the count of photons absorbed by the\nfour pixels on the crystal panels. The photon counts were recorded for 84\nenergy bins ranging from 550 to 800 keV. To process this raw measurement\ndataset into the input dataset of our neural network model, we summed the\nphoton counts absorbed by each pixel across this entire energy region of\ninterest.\n\nThe initial detector signals exhibited significant statistical fluctuations,\nmaking it challenging to predict the radiation source direction accurately.\nWhen the detector remained stationary at the starting pose, the radiation\nsource direction predicted by our algorithm changed abruptly in the early\ntimestamps. To mitigate this issue, we implemented a signal-smoothing\ntechnique using a moving average filter written in Eq. (13). This process\nsmoothed the detector\u2019s signals by averaging the signals of the neighboring 2M\n+ 1 timestamps. We used M, equal to 3, resulting in a window size of 7\ntimestamps. This smoothing technique reduced the total number of timestamps\nfrom 91 to 85. The smoothed signal data served as the input for our machine-\nlearning model:\n\n$${{{{{{{{\\bf{x}}}}}}}}}_{t}^{{\\prime} }=\\frac{1}{2M+1}\\mathop{\\sum\n}\\limits_{i=-M}^{M}{{{{{{{{\\bf{x}}}}}}}}}_{t+M+i}$$\n\n(13)\n\nWe employed a U-Net architecture trained using MC simulation data to predict\nthe direction of the radiation source given the signals from the detector of 2\n\u00d7 2 configuration. The trained model was then applied to predict the radiation\ndirection based on the smoothed measurement data. With directional information\npredicted by our model at each timestamp, we applied the MAP method to\nreconstruct the radiation map. We restricted the MAP analysis to a 15 \u00d7 15\nsquare area within the entire space to reduce computational complexity.\n\n## Data availability\n\nThe Supplementary Movies showing the radiation mapping processes are\navailable. The training data generated with the OpenMC^28 package have been\ndeposited in the GitHub repository\n(https://github.com/RyotaroOKabe/radiation_mapping/tree/main/save/openmc_data/saved_files).\n\n## Code availability\n\nThe source code is available at\nhttps://github.com/RyotaroOKabe/radiation_mapping.git^42. The GitHub\nrepository and Supplementary Note 8 present the instructions for reproducing\nthe results of our simulations and machine learning.\n\n## References\n\n  1. Connor, D., Martin, P. G. & Scott, T. B. Airborne radiation mapping: overview and application of current and future aerial systems. Int. J. Remote Sens. 37, 5953\u20135987 (2016).\n\nArticle Google Scholar\n\n  2. Lazna, T., Jilek, T., Gabrlik, P. & Zalud, L. Multi-robotic area exploration for environmental protection. In International Conference on Industrial Applications of Holonic and Multi-Agent Systems, 240\u2013254 (Springer, 2017).\n\n  3. Christie, G. et al. Radiation search operations using scene understanding with autonomous UAV and UGV. J. Field Robot. 34, 1450\u20131468 (2017).\n\nArticle Google Scholar\n\n  4. Guzman, R., Navarro, R., Ferre, J. & Moreno, M. Rescuer: development of a modular chemical, biological, radiological, and nuclear robot for intervention, sampling, and situation awareness. J. Field Robot. 33, 931\u2013945 (2016).\n\nArticle Google Scholar\n\n  5. Towler, J., Krawiec, B. & Kochersberger, K. Radiation mapping in post-disaster environments using an autonomous helicopter. Remote Sens. 4, 1995\u20132015 (2012).\n\nArticle ADS Google Scholar\n\n  6. Pavlovsky, R. et al. 3-D radiation mapping in real-time with the localization and mapping platform lamp from unmanned aerial systems and man-portable configurations. arXiv https://doi.org/10.48550/arXiv.1901.05038 (2018).\n\n  7. Hellfeld, D. et al. Gamma-ray point-source localization and sparse image reconstruction using Poisson likelihood. IEEE Trans. Nucl. Sci. 66, 2088\u20132099 (2019).\n\nArticle ADS CAS Google Scholar\n\n  8. Briones, L., Bustamante, P. & Serna, M. A. Wall-climbing robot for inspection in nuclear power plants. In Proceedings of the 1994 IEEE International Conference on Robotics and Automation, 1409\u20131414 (IEEE, 1994).\n\n  9. Mazumdar, A., Fittery, A., Ubellacker, W. & Asada, H. H. A ball-shaped underwater robot for direct inspection of nuclear reactors and other water-filled infrastructure. In 2013 IEEE International Conference on Robotics and Automation, 3415\u20133422 (IEEE, 2013).\n\n  10. Amman, M. et al. Detector module development for the high efficiency multimode imager. In 2009 IEEE Nuclear Science Symposium Conference Record (NSS/MIC), 981\u2013985 (IEEE, 2009).\n\n  11. Caroli, E., Stephen, J., Di Cocco, G., Natalucci, L. & Spizzichino, A. Coded aperture imaging in x-and gamma-ray astronomy. Space Sci. Rev. 45, 349\u2013403 (1987).\n\nArticle ADS Google Scholar\n\n  12. Galloway, M., Zoglauer, A., Amman, M., Boggs, S. E. & Luke, P. N. Simulation and detector response for the high efficiency multimode imager. Nucl. Instrum. Methods Phys. Res. Sect. A Accel. Spectrometers Detect. Assoc. Equip. 652, 641\u2013645 (2011).\n\nArticle ADS CAS Google Scholar\n\n  13. Vetter, K. et al. Gamma-ray imaging for nuclear security and safety: towards 3-d gamma-ray vision. Nucl. Instrum. Methods Phys. Res. Sect. A Accel. Spectrometers Detect. Assoc. Equip. 878, 159\u2013168 (2018).\n\nArticle ADS CAS Google Scholar\n\n  14. Hanna, D., Sagni\u00e8res, L., Boyle, P. & MacLeod, A. A directional gamma-ray detector based on scintillator plates. Nucl. Instrum. Methods Phys. Res. Sect. A Accel. Spectrometers Detect. Assoc. Equip. 797, 13\u201318 (2015).\n\nArticle ADS CAS Google Scholar\n\n  15. Cadena, C. et al. Past, present, and future of simultaneous localization and mapping: toward the robust-perception age. IEEE Trans. Robot. 32, 1309\u20131332 (2016).\n\nArticle Google Scholar\n\n  16. Vavrek, J. R. et al. Reconstructing the position and intensity of multiple gamma-ray point sources with a sparse parametric algorithm. IEEE Trans. Nucl. Sci. 67, 2421\u20132430 (2020).\n\nArticle ADS CAS Google Scholar\n\n  17. Pavlovsky, R. et al. MiniPRISM: 3D realtime gamma-ray mapping from small unmanned aerial systems and handheld scenarios. In IEEE NSS-MIC Conference Record (IEEE, 2019).\n\n  18. Hellfeld, D. et al. Free-moving quantitative gamma-ray imaging. Sci. Rep. 11, 1\u201314 (2021).\n\nArticle Google Scholar\n\n  19. Vavrek, J. R. et al. 4\u03c0 multi-crystal gamma-ray and neutron response modeling of a dual modality imaging system. In IEEE Symposium on Radiation Measurements and Applications (SORMA West) (2021).\n\n  20. Kitayama, Y., Nogami, M. & Hitomi, K. Feasibility study on a gamma-ray imaging using three-dimensional shadows of gamma rays. In IEEE NSS-MIC (2022).\n\n  21. Hu, Y. et al. A wide energy range and 4\u03c0-view gamma camera with interspaced position-sensitive scintillator array and embedded heavy metal bars. Sensors 23, 953 (2023).\n\nArticle ADS CAS PubMed PubMed Central Google Scholar\n\n  22. Sinclair, L. et al. Silicon photomultiplier-based compton telescope for safety and security (SCoTSS). IEEE Trans. Nucl. Sci. 61, 2745\u20132752 (2014).\n\nArticle ADS CAS Google Scholar\n\n  23. Sinclair, L. E. et al. End-user experience with the SCoTSS Compton imager and directional survey spectrometer. Nucl. Instrum. Methods Phys. Res. Sect. A Accel. Spectrometers Detect. Assoc. Equip. 954, 161683 (2020).\n\nArticle CAS Google Scholar\n\n  24. Murtha, N., Sinclair, L., Saull, P., McCann, A. & MacLeod, A. Tomographic reconstruction of a spatially-extended source from the perimeter of a restricted-access zone using a SCoTSS compton gamma imager. J. Environ. Radioact. 240, 106758 (2021).\n\nArticle CAS PubMed Google Scholar\n\n  25. Bonomally, S., Ihantola, S. & Vacheret, A. Enhancing source detection for threat localization. Poster presented at Nuclear Security Detection Workshop. https://indico.cern.ch/event/731980/contributions/3285768/attachments/1829613/2995886/VACHARET_NuSec-Poster-2017.pdf (2017).\n\n  26. Cortesi, M., Zboray, R., Adams, R., Dangendorf, V. & Prasser, H.-M. Concept of a novel fast neutron imaging detector based on THGEM for fan-beam tomography applications. J. Instrum. 7, C02056 (2012).\n\nArticle Google Scholar\n\n  27. Breskin, A. et al. Large-area high-resolution thermal neutron imaging detectors. In International Conference on Neutrons and Their Applications, Vol. 2339, 281\u2013286 (SPIE, 1995).\n\n  28. Romano, P. K. et al. OpenMC: a state-of-the-art Monte Carlo code for research and development. Ann. Nucl. Energy 82, 90\u201397 (2015).\n\nArticle CAS Google Scholar\n\n  29. Clevert, D.-A., Unterthiner, T. & Hochreiter, S. Fast and accurate deep network learning by exponential linear units (elus). arXiv https://doi.org/10.48550/arXiv.1511.07289 (2015).\n\n  30. LeCun, Y., Bengio, Y. & Hinton, G. Deep learning. Nature 521, 436\u2013444 (2015).\n\nArticle ADS CAS PubMed Google Scholar\n\n  31. Ronneberger, O., Fischer, P. & Brox, T. U-net: convolutional networks for biomedical image segmentation. In International Conference on Medical Image Computing and Computer-assisted Intervention, 234\u2013241 (Springer, 2015).\n\n  32. Talebi, H. & Milanfar, P. Nima: neural image assessment. IEEE Trans. Image Process. 27, 3998\u20134011 (2018).\n\nArticle ADS MathSciNet Google Scholar\n\n  33. Hou, L., Yu, C.-P. & Samaras, D. Squared Earth mover\u2019s distance-based loss for training deep neural networks. arXiv https://doi.org/10.48550/arXiv.1611.05916 (2016).\n\n  34. Genevay, A., Peyr\u00e9, G. & Cuturi, M. Learning generative models with sinkhorn divergences. In International Conference on Artificial Intelligence and Statistics, 1608\u20131617 (PMLR, 2018).\n\n  35. Levina, E. & Bickel, P. The Earth mover\u2019s distance is the mallows distance: some insights from statistics. In Proceedings Eighth IEEE International Conference on Computer Vision. ICCV 2001, Vol. 2, 251\u2013256 (IEEE, 2001).\n\n  36. Shalev-Shwartz, S. & Tewari, A. Stochastic methods for l 1 regularized loss minimization. In Proceedings of the 26th Annual International Conference on Machine Learning, 929\u2013936 (2009).\n\n  37. Kingma, D. P. & Ba, J. Adam: a method for stochastic optimization. arXiv https://doi.org/10.48550/arXiv.1412.6980 (2014).\n\n  38. Agrawal, A. et al. Differentiable convex optimization layers. In Advances in Neural Information Processing Systems 32 (NeurIPS, 2019).\n\n  39. Pavlovsky, R. et al. 3D gamma-ray and neutron mapping in real-time with the Localization and Mapping Platform from unmanned aerial systems and man-portable configurations. arXiv https://doi.org/10.48550/arXiv.1908.06114 (2019).\n\n  40. Wang, R., Peethambaran, J. & Chen, D. Lidar point clouds to 3-D urban models: a review. IEEE J. Sel. Top. Appl. Earth Obs. Remote Sens. 11, 606\u2013627 (2018).\n\nArticle ADS Google Scholar\n\n  41. Zhou, Q.-Y., Park, J. & Koltun, V. Open3d: a modern library for 3d data processing. arXiv https://doi.org/10.48550/arXiv.1801.09847 (2018).\n\n  42. Okabe, R., Xue, S. & Vavrek, J. Tetris-inspired detector with neural network for radiation mapping. https://zenodo.org/doi/10.5281/zenodo.10685051; https://doi.org/10.5281/zenodo.10685051 (2024).\n\nDownload references\n\n## Acknowledgements\n\nR.O. and M.L. thank the helpful discussions from F. Frankel. R.O., T.L., G.K.,\nand M.L. acknowledge the support from U.S. Department of Energy (DOE),\nAdvanced Research Projects Agency-Energy (ARPA-E) DE-AR0001298. R.O. and M.L.\nare partly supported by DOE Basic Energy Sciences (BES), Award No. DE-\nSC0021940. R.O. acknowledges support from Heiwa Nakajima Foundation. M.L.\nacknowledges the Norman C Rasmussen Career Development Chair, the MIT Class of\n1947 Career Development Chair, and the support from Dr. R. Wachnik. This\nmanuscript has been authored by an author at Lawrence Berkeley National\nLaboratory under Contract No. DE-AC02-05CH11231 with the U.S. Department of\nEnergy. The U.S. Government retains, and the publisher, by accepting the\narticle for publication, acknowledges, that the U.S. Government retains a non-\nexclusive, paid-up, irrevocable, world-wide license to publish or reproduce\nthe published form of this manuscript, or allow others to do so, for U.S.\nGovernment purposes.\n\n## Author information\n\nAuthor notes\n\n  1. These authors contributed equally: Ryotaro Okabe, Shangjie Xue, Jayson R. Vavrek.\n\n### Authors and Affiliations\n\n  1. Quantum Measurement Group, Massachusetts Institute of Technology, Cambridge, MA, 02139, USA\n\nRyotaro Okabe, Shangjie Xue, Tongtong Liu & Mingda Li\n\n  2. Department of Chemistry, Massachusetts Institute of Technology, Cambridge, MA, 02139, USA\n\nRyotaro Okabe\n\n  3. Department of Nuclear Science and Engineering, Massachusetts Institute of Technology, Cambridge, MA, 02139, USA\n\nShangjie Xue, Jiankai Yu, Benoit Forget & Mingda Li\n\n  4. Department of Electrical Engineering and Computer Science, Massachusetts Institute of Technology, Cambridge, MA, 02139, USA\n\nShangjie Xue & Stefanie Jegelka\n\n  5. Applied Nuclear Physics Program, Lawrence Berkeley National Laboratory, Berkeley, CA, 94720, USA\n\nJayson R. Vavrek, Ryan Pavlovsky, Victor Negut, Brian J. Quiter & Joshua W.\nCates\n\n  6. Department of Physics, Massachusetts Institute of Technology, Cambridge, MA, 02139, USA\n\nTongtong Liu\n\n  7. Nuclear Reactor Laboratory, Massachusetts Institute of Technology, Cambridge, MA, 02139, USA\n\nGordon Kohse & Lin-wen Hu\n\nAuthors\n\n  1. Ryotaro Okabe\n\nView author publications\n\nYou can also search for this author in PubMed Google Scholar\n\n  2. Shangjie Xue\n\nView author publications\n\nYou can also search for this author in PubMed Google Scholar\n\n  3. Jayson R. Vavrek\n\nView author publications\n\nYou can also search for this author in PubMed Google Scholar\n\n  4. Jiankai Yu\n\nView author publications\n\nYou can also search for this author in PubMed Google Scholar\n\n  5. Ryan Pavlovsky\n\nView author publications\n\nYou can also search for this author in PubMed Google Scholar\n\n  6. Victor Negut\n\nView author publications\n\nYou can also search for this author in PubMed Google Scholar\n\n  7. Brian J. Quiter\n\nView author publications\n\nYou can also search for this author in PubMed Google Scholar\n\n  8. Joshua W. Cates\n\nView author publications\n\nYou can also search for this author in PubMed Google Scholar\n\n  9. Tongtong Liu\n\nView author publications\n\nYou can also search for this author in PubMed Google Scholar\n\n  10. Benoit Forget\n\nView author publications\n\nYou can also search for this author in PubMed Google Scholar\n\n  11. Stefanie Jegelka\n\nView author publications\n\nYou can also search for this author in PubMed Google Scholar\n\n  12. Gordon Kohse\n\nView author publications\n\nYou can also search for this author in PubMed Google Scholar\n\n  13. Lin-wen Hu\n\nView author publications\n\nYou can also search for this author in PubMed Google Scholar\n\n  14. Mingda Li\n\nView author publications\n\nYou can also search for this author in PubMed Google Scholar\n\n### Contributions\n\nR.O. took the lead in the project. R.O. and S.X. developed the machine\nlearning model. R.O. performed the Monte Carlo simulations with support from\nT.L., J.Y. and B.F. R.O. wrote the manuscript with support from S.X. and J.V.\nJ.V., R.P., V.N., B.Q. and J.C. carried out the experiment. R.O., S.X. and\nJ.V. carried out data analysis. M.L., S.J., G.K. and L.H. designed the\nproject, provided supervision, and revised the manuscript.\n\n### Corresponding authors\n\nCorrespondence to Ryotaro Okabe, Lin-wen Hu or Mingda Li.\n\n## Ethics declarations\n\n### Competing interests\n\nThe authors declare no competing interests.\n\n## Peer review\n\n### Peer review information\n\nNature Communications thanks Hong Joo Kim, Liqian Li and Nicholas Maliszewskyj\nfor their contribution to the peer review of this work. A peer review file is\navailable.\n\n## Additional information\n\nPublisher\u2019s note Springer Nature remains neutral with regard to jurisdictional\nclaims in published maps and institutional affiliations.\n\n## Supplementary information\n\n### Supplementary Information\n\n### Peer Review File\n\n### Description of Additional Supplementary Files\n\n### Supplementary Movie 1\n\n### Supplementary Movie 2\n\n### Supplementary Movie 3\n\n### Supplementary Movie 4\n\n### Supplementary Movie 5\n\n### Supplementary Movie 6\n\n### Supplementary Movie 7\n\n### Supplementary Movie 8\n\n### Supplementary Movie 9\n\n### Supplementary Movie 10\n\n### Supplementary Movie 11\n\n## Rights and permissions\n\nOpen Access This article is licensed under a Creative Commons Attribution 4.0\nInternational License, which permits use, sharing, adaptation, distribution\nand reproduction in any medium or format, as long as you give appropriate\ncredit to the original author(s) and the source, provide a link to the\nCreative Commons licence, and indicate if changes were made. The images or\nother third party material in this article are included in the article\u2019s\nCreative Commons licence, unless indicated otherwise in a credit line to the\nmaterial. If material is not included in the article\u2019s Creative Commons\nlicence and your intended use is not permitted by statutory regulation or\nexceeds the permitted use, you will need to obtain permission directly from\nthe copyright holder. To view a copy of this licence, visit\nhttp://creativecommons.org/licenses/by/4.0/.\n\nReprints and permissions\n\n## About this article\n\n### Cite this article\n\nOkabe, R., Xue, S., Vavrek, J.R. et al. Tetris-inspired detector with neural\nnetwork for radiation mapping. Nat Commun 15, 3061 (2024).\nhttps://doi.org/10.1038/s41467-024-47338-w\n\nDownload citation\n\n  * Received: 07 February 2023\n\n  * Accepted: 27 March 2024\n\n  * Published: 09 April 2024\n\n  * DOI: https://doi.org/10.1038/s41467-024-47338-w\n\n### Share this article\n\nAnyone you share the following link with will be able to read this content:\n\nSorry, a shareable link is not currently available for this article.\n\nProvided by the Springer Nature SharedIt content-sharing initiative\n\n### Subjects\n\n  * Computational science\n  * Mechanical engineering\n  * Scientific data\n\n## Comments\n\nBy submitting a comment you agree to abide by our Terms and Community\nGuidelines. If you find something abusive or that does not comply with our\nterms or guidelines please flag it as inappropriate.\n\nDownload PDF\n\nAdvertisement\n\nNature Communications (Nat Commun) ISSN 2041-1723 (online)\n\n## nature.com sitemap\n\n### About Nature Portfolio\n\n  * About us\n  * Press releases\n  * Press office\n  * Contact us\n\n### Discover content\n\n  * Journals A-Z\n  * Articles by subject\n  * protocols.io\n  * Nature Index\n\n### Publishing policies\n\n  * Nature portfolio policies\n  * Open access\n\n### Author & Researcher services\n\n  * Reprints & permissions\n  * Research data\n  * Language editing\n  * Scientific editing\n  * Nature Masterclasses\n  * Research Solutions\n\n### Libraries & institutions\n\n  * Librarian service & tools\n  * Librarian portal\n  * Open research\n  * Recommend to library\n\n### Advertising & partnerships\n\n  * Advertising\n  * Partnerships & Services\n  * Media kits\n  * Branded content\n\n### Professional development\n\n  * Nature Careers\n  * Nature Conferences\n\n### Regional websites\n\n  * Nature Africa\n  * Nature China\n  * Nature India\n  * Nature Italy\n  * Nature Japan\n  * Nature Middle East\n\n  * Privacy Policy\n  * Use of cookies\n  * Legal notice\n  * Accessibility statement\n  * Terms & Conditions\n  * Your US state privacy rights\n  * Cancel contracts here\n\n\u00a9 2024 Springer Nature Limited\n\nSign up for the Nature Briefing newsletter \u2014 what matters in science, free to\nyour inbox daily.\n\nGet the most important science stories of the day, free in your inbox. Sign up\nfor Nature Briefing\n\n", "frontpage": false}
