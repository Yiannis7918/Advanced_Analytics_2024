{"aid": "40029945", "title": "Database Passwords in Server Response in Amazon AWS Glue", "url": "https://sec-consult.com/vulnerability-lab/advisory/database-passwords-in-server-response-in-amazon-aws-glue/", "domain": "sec-consult.com", "votes": 1, "user": "campuscodi", "posted_at": "2024-04-14 09:42:55", "comments": 0, "source_title": "Database Passwords in Server Response in Amazon AWS Glue", "source_text": "Database Passwords in Server Response in Amazon AWS Glue - SEC Consult\n\n# Database Passwords in Server Response in Amazon AWS Glue\n\nTitle\n\nDatabase Passwords in Server Response\n\nProduct\n\nAmazon AWS Glue\n\nVulnerable Version\n\nuntil 2024-02-23\n\nFixed Version\n\nas of 2024-02-23\n\nCVE Number\n\n-\n\nImpact\n\nmedium\n\nHomepage\n\nhttps://aws.amazon.com/glue/\n\nFound\n\n05.05.2023\n\nBy\n\nMichael Werner (Eviden) | SEC Consult Vulnerability Lab\n\nThe password of database connections in Amazon AWS Glue is loaded into the\nwebsite when a connection's edit page is requested. Principals with\nappropriate permissions can read the password. This behavior also increases\nthe risk that database passwords will be intercepted by an attacker during\ntransmission in the server response. Many types of vulnerabilities, such as\nbroken access control, cross-site scripting and weaknesses in session\nhandling, could enable an attacker to leverage this behavior to retrieve the\npasswords.\n\n## Vendor description\n\n\"AWS Glue is a serverless data integration service that makes it easier to\ndiscover, prepare, move, and integrate data from multiple sources for\nanalytics, machine learning (ML), and application development.\"\n\nSource: https://aws.amazon.com/glue/\n\n## Business recommendation\n\nThe vendor has fixed the issue in the currently available version on all\ninstances world-wide as of 2024-02-23.\n\n## Vulnerability overview/description\n\n### 1) Database Passwords in Server Response\n\nThe password of database connections in AWS Glue is loaded into the website\nwhen a connection's edit page is requested. Principals with appropriate\npermissions can read the password. This behavior also increases the risk that\ndatabase passwords will be intercepted by an attacker during transmission in\nthe server response. Many types of vulnerabilities, such as broken access\ncontrols, cross-site scripting and weaknesses in session handling, could\nenable an attacker to leverage this behavior to retrieve the passwords.\n\n## Proof of concept\n\n### 1) Database Passwords in Server Response\n\nThe following steps are necessary to reconstruct the vulnerability:\n\n  1. Login to the AWS Console and switch to the Glue module.\n  2. Go to \"Data connections\" and create a new connection.\n  3. Choose a connection type that allows username / password authentication (e.g. JDBC) - see figure 1.\n  4. Open the new connection's \"Edit\" page and inspect the password field e.g. with the browser's DevTools - see figure 2.\n\nFigure 1: AWS Glue Connection Config: connection type allowing username /\npassword authenticationFigure 2: Plain text password visible via browser dev\ntools\n\nThe following permissions were used:\n\n  * glue:GetConnections (for the list view of connections; not necessary to open the connection page itself if the connection name is known)\n  * glue:GetConnection (for opening the connection page)\n  * ec2:DescribeSubnets (for opening the edit page of a connection)\n\n### Permission Summary\n\nA principal only needs the permissions glue:GetConnection and\nec2:DescribeSubnets to retrieve the database password of a connection. The\nattacker also needs either knowledge of the connection's name to open the edit\npage directly (e.g. us-east-1.console.aws.amazon.com/gluestudio/home) or the\npermission glue:GetConnections to list existing connections.\n\n## Vulnerable / tested versions\n\nThe version that was current at 2023-05-10 has been tested and found to be\nvulnerable.\n\n## Vendor contact timeline\n\n2023-06-07| Contacting vendor through aws-security@amazon.com  \n---|---  \n2023-06-07| Vendor response, provides PGP key, sending encrypted security\nadvisory.  \n2023-06-08| Vendor response, team is investigating the report, asking about\npublic disclosure timeline.  \n2023-06-16| Vendor is still working on the report, will inform us on a weekly\nbasis.  \n2023-07-24| Vendor requires additional time, next update will be early\nSeptember, provides weekly updates.  \n2023-09-14| Vendor team is working on rolling out a fix.  \n2023-09-21| Vendor encountered roll-out issues, full mass deployment now\nscheduled to be finished in 2023Q4.  \n2023-10-05| Vendor hit \"first milestone\" in their development, 3-staged\napproach.  \n2023-10-25| Vendor hit second milestone before full rollout.  \n2024-02-14| Asking for a status update.  \n2024-02-15| Vendor is still working on the issue. Asking them for a timeline.  \n2024-02-23| Vendor reports that fix is implemented and deployed worldwide.\nCoordinating public release.  \n2024-02-28| Sending details where we publish the advisory, asking for a CVE\nnumber.  \n2024-03-01| Vendor asks whether we meant CVE or CVSS.  \n2024-04-08| Clarifying that we mean CVE, but CVE not needed for cloud. Setting\nrelease date to 11th April.  \n2024-04-11| Coordinated release of security advisory.  \n  \n## Solution\n\nThe vendor has fixed the issue and deployed the patch worldwide as of as of\n2024-02-23.\n\n## Workaround\n\nNone\n\n## Advisory URL\n\nhttps://sec-consult.com/vulnerability-lab/\n\nEOF Michael Werner / @2024\n\nInterested to work with the experts of SEC Consult? Send us your application\n\nInterested in improving your cyber security with the experts of SEC Consult?\nContact our local offices\n\nBack\n\nSEC Consult is one of the leading consultancies in the field of cyber and\napplication security. The company specializes in information security\nmanagement, NIS security audits, penetration testing, ISO 27001 certification\nsupport, Cyber Defence and secure software certification. SEC Consult is part\nof Eviden.\n\n## We use Cookies\n\nWe use cookies to offer you a perfect visit experience. These include cookies\nthat are necessary for the operation of the site and for the control of our\ncommercial corporate goals, as well as those that are only used for anonymous\nstatistical purposes, for convenience settings or to display personalized\ncontent. Decide for yourself which categories you want to allow. Please note\nthat based on your settings, not all functions of the site may be available.\n\nLegal Notice \u2022 Privacy Statement\n\n", "frontpage": false}
