{"aid": "40016468", "title": "Cipherleaks is the first demonstrated attack against AMD SEV-SNP", "url": "https://cipherleaks.com/", "domain": "cipherleaks.com", "votes": 10, "user": "todsacerdoti", "posted_at": "2024-04-12 19:02:08", "comments": 0, "source_title": "Home", "source_text": "Home | CIPHERLEAKs\n\nHome | CIPHERLEAKs: Ciphertext Side Channels on AMD SEV\n\n# CIPHERLEAKs\n\nCipherleaks is the first demonstrated attack against AMD SEV-SNP. It exploits\na vulnerable design feature of SEV's memory encryption and uses the ciphertext\nof the encrypted VM Save Area (VMSA) as side channels to breach constant-time\nRSA and ECDSA implementation of the latest OpenSSL library.\n\n## What is CIPHERLEAKs?\n\nCIPHERLEAKs\n\n## Root causes of the vulnerability\n\nTwo features in the design of SEV (and SEV-SNP) caused this vulnerability\n\n  * SEV hardware encrypts the VM's memory using 128-bit AES symmetric encryption. The AES engine integrated into the AMD System-on-Chip (SOC) automatically encrypts the data when it is written to the memory and automatically decrypts the data when it is read from memory. Latest SEV processors adopt the XOR-Encrypt-XOR (XEX) encryption mode in the memory encryption where the ciphertext is calculated by c=ENC(m\u2295T(Pm))\u2295T(Pm). The 128-bit entropy tweak function T() fixed all existing vulnerabilities in SEV AES encryption. However, the same plaintext always has the same ciphertext in system physical address Pm during the lifetime of a guest VM.\n\n  * For performance optimization, SEV (including SEV-ES and SEV-SNP) does not prevent the hypervisor from read accessing the ciphertext of the encrypted memory.\n\n## Ciphertext side channels\n\nBy monitoring the changes in the ciphertext of the victim VM, the adversary is\nable to infer the changes of the corresponding plaintext. This ciphertext side\nchannel may seem innocuous at first glance, but when applied to certain\nencrypted memory regions, it may be exploited to infer the execution of the\nvictim VM. Specifically, we target at monitoring the ciphertext of the VMSA.\nWe particularly construct two attack primitives: execution state inference and\nplaintext recovery. Execution state inference can help locate the physical\naddress of targeted functions and infer the executing function of a process.\nThe ciphertext side channel can also be exploited to recover the plaintext\nfrom some of the ciphertext blocks. To recover plaintext from the ciphertext,\nthe adversary first needs to build a dictionary of plaintext-ciphertext pairs\nfor the targeted registers, and then make use of the dictionary to recover the\nplaintext value of the registers of interest during the execution of a\nsensitive application.\n\n## Case studies\n\nWe present two case studies to illustrate the CIPHERLEAKs attack. In the first\nattack, we show that the constant-time RSA implementation in OpenSSL can be\nbroken with known ciphertext for the plaintext values of 0 to 31 (which can be\neasily collected during VM's lifecycle). In the second attack, we show that\nthe constant-time ECDSA signature can be compromised with known ciphertext of\nthe plaintext values of 0 and 1. In both of the two cases we presented, the\nadversary can recover the private key d of RSA encryption and the secret nonce\nk in ECDSA signature with 100% accuracy.\n\n## Disclosure\n\nWe disclosed the vulnerability of the ciphertext side channel and the\nCIPHERLEAKs attack to AMD team. AMD engineers have acknowledged the\nvulnerability on SEV, SEV-ES, and SEV-SNP, and filed an embargo that is\neffective until August 10, 2021. As of the time of writing, CVE number,\nCVE-2020-12966, has been reserved for the vulnerability. AMD also announces a\nsecurity bulletin together with a hardware patch for SEV-SNP in August 2021\n(https://www.amd.com/en/corporate/product-security/bulletin/amd-sb-1013).\n\n## Research Paper\n\nDocs\n\n### Read our paper\n\nRead more details about CIPHERLEAKs.\n\nCite\n\n### Cite our paper\n\nExplore AMD SEV.\n\n## People\n\nMengyuan Li (The Ohio State University)\n\nYinqian Zhang (Southern University of Science and Technology)\n\nHuibo Wang (Baidu Security)\n\nKang Li (Baidu Security)\n\nYueqiang Cheng (NIO Security Research)\n\n## Q&A\n\n## Essential Links\n\n### Documents\n\n  * [SEV] AMD Memory Encryption\n\n    * SEV API\n  * [SEV-ES] Protecting VM Register State With SEV-ES\n\n    * SEV-ES API\n    * Guest Hypervisor Communication Block (GHCB) Standardization\n  * [SEV-SNP] AMD SEV-SNP\n\n    * SEV Secure Nested Paging Firmware ABI Specification\n  * [Manual] AMD64 Architecture Programmer\u2019s Manual Volume 2\n\n### SEV Software support\n\n  * [Software Support] How to setup AMD SEV\n\n    * SEV-ES Branch\n    * SEV-SNP Branch\n  * [SEV-Tool] AMD SEV Tool for managing SEV platform certificates\n  * [Container] SEV runtime for Kata Containers\n\n## Explore \u2192\n\nCopyright \u00a9 2021 CIPHERLEAKs\n\nMediumish Jekyll Theme by WowThemes.net\n\n", "frontpage": true}
