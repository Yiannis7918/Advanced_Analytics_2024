{"aid": "39960107", "title": "Command Injection and Backdoor Account in D-Link NAS Devices", "url": "https://github.com/netsecfish/dlink", "domain": "github.com/netsecfish", "votes": 4, "user": "campuscodi", "posted_at": "2024-04-07 11:39:17", "comments": 0, "source_title": "GitHub - netsecfish/dlink", "source_text": "GitHub - netsecfish/dlink\n\nSkip to content\n\nSign in\n\n# Search code, repositories, users, issues, pull requests...\n\nSearch syntax tips\n\nSign in\n\nSign up\n\nYou signed in with another tab or window. Reload to refresh your session. You\nsigned out in another tab or window. Reload to refresh your session. You\nswitched accounts on another tab or window. Reload to refresh your session.\nDismiss alert\n\nnetsecfish / dlink Public\n\n  * Notifications\n  * Fork 2\n  * Star 5\n\n5 stars 2 forks Branches Tags Activity\n\nStar\n\nNotifications\n\n# netsecfish/dlink\n\nThis commit does not belong to any branch on this repository, and may belong\nto a fork outside of the repository.\n\n1 Branch\n\n0 Tags\n\n## Folders and files\n\nName| Name| Last commit message| Last commit date  \n---|---|---|---  \n  \n## Latest commit\n\nnetsecfishUpdate README.mded70160 \u00b7\n\n## History\n\n5 Commits  \n  \n### README.md\n\n|\n\n### README.md\n\n| Update README.md  \n  \n### dns-320.jpg\n\n|\n\n### dns-320.jpg\n\n| Add files via upload  \n  \n### fofa-result.png\n\n|\n\n### fofa-result.png\n\n| Add files via upload  \n  \n## Repository files navigation\n\n# Command Injection and Backdoor Account in D-Link NAS Devices\n\n## Vulnerability Summary:\n\nThe described vulnerability affects multiple D-Link NAS devices, including\nmodels DNS-340L, DNS-320L, DNS-327L, and DNS-325, among others. The\nvulnerability lies within the nas_sharing.cgi uri, which is vulnerable due to\ntwo main issues: a backdoor facilitated by hardcoded credentials, and a\ncommand injection vulnerability via the system parameter. This exploitation\ncould lead to arbitrary command execution on the affected D-Link NAS devices,\ngranting attackers potential access to sensitive information, system\nconfiguration alteration, or denial of service, by specifying a\ncommand,affecting over 92,000 devices on the Internet.\n\n## Corresponding CWE\n\nCWE-77 (Command Injection) and CWE-798 (Use of Hard-coded Credentials).\n\n## Affected Devices:\n\n  * DNS-320L Version 1.11, Version 1.03.0904.2013, Version 1.01.0702.2013\n  * DNS-325 Version 1.01\n  * DNS-327L Version 1.09, Version 1.00.0409.2013\n  * DNS-340L Version 1.08\n\n## Vulnerability Details:\n\nThe vulnerability exists in the nas_sharing.cgi CGI script, which leads to:\n\n  1. Backdoor through Username and Password Exposure: The request includes parameters for a username (user=messagebus) and an empty password field (passwd=). This indicates a backdoor allowing unauthorized access without proper authentication.\n  2. Command Injection through the System Parameter: The system parameter within the request carries a base64 encoded value that, when decoded, appears to be a command.\n\n## Exploitation:\n\nCraft Malicious HTTP Request: Prepare an HTTP GET request targeting the /cgi-\nbin/nas_sharing.cgi endpoint.\n\n    \n    \n    GET /cgi-bin/nas_sharing.cgi?user=messagebus&passwd=&cmd=15&system=<BASE64_ENCODED_COMMAND_TO_BE_EXECUTED>\n\n## Actual Result\n\n## Impact:\n\nSuccessful exploitation of this vulnerability could allow an attacker to\nexecute arbitrary commands on the system, potentially leading to unauthorized\naccess to sensitive information, modification of system configurations, or\ndenial of service conditions.\n\n## Fix Recommendation:\n\n  * Apply available patches and updates from the device manufacturer.\n\n## About\n\nNo description, website, or topics provided.\n\n### Resources\n\nReadme\n\nActivity\n\n### Stars\n\n5 stars\n\n### Watchers\n\n1 watching\n\n### Forks\n\n2 forks\n\nReport repository\n\n## Releases\n\nNo releases published\n\n## Packages 0\n\nNo packages published\n\n## Footer\n\n\u00a9 2024 GitHub, Inc.\n\nYou can\u2019t perform that action at this time.\n\n", "frontpage": true}
