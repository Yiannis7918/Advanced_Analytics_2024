{"aid": "39958495", "title": "Show HN: A Postgres extension to save you from accidental mistake(s)", "url": "https://github.com/viggy28/pg_savior", "domain": "github.com/viggy28", "votes": 2, "user": "vira28", "posted_at": "2024-04-07 06:01:49", "comments": 0, "source_title": "GitHub - viggy28/pg_savior: A postgres extension to avoid accidental mistakes", "source_text": "GitHub - viggy28/pg_savior: A postgres extension to avoid accidental mistakes\n\nSkip to content\n\nSign in\n\n# Search code, repositories, users, issues, pull requests...\n\nSearch syntax tips\n\nSign in\n\nSign up\n\nYou signed in with another tab or window. Reload to refresh your session. You\nsigned out in another tab or window. Reload to refresh your session. You\nswitched accounts on another tab or window. Reload to refresh your session.\nDismiss alert\n\nviggy28 / pg_savior Public\n\n  * Notifications\n  * Fork 2\n  * Star 31\n\nA postgres extension to avoid accidental mistakes\n\n### License\n\nApache-2.0 license\n\n31 stars 2 forks Branches Tags Activity\n\nStar\n\nNotifications\n\n# viggy28/pg_savior\n\nThis commit does not belong to any branch on this repository, and may belong\nto a fork outside of the repository.\n\n1 Branch\n\n0 Tags\n\n## Folders and files\n\nName| Name| Last commit message| Last commit date  \n---|---|---|---  \n  \n## Latest commit\n\nviggy28Problem: pg_savior is under active dev93ae57d \u00b7\n\n## History\n\n15 Commits  \n  \n### rules\n\n|\n\n### rules\n\n| problem: pg_savior didn't have any tests  \n  \n### tests\n\n|\n\n### tests\n\n| problem: pg_savior didn't have any tests  \n  \n### .gitignore\n\n|\n\n### .gitignore\n\n| Problem: unnecessary logging added  \n  \n### LICENSE\n\n|\n\n### LICENSE\n\n| Create LICENSE  \n  \n### Makefile\n\n|\n\n### Makefile\n\n| initial commit  \n  \n### README.md\n\n|\n\n### README.md\n\n| Problem: the description is not clear  \n  \n### pg_savior--0.0.1.sql\n\n|\n\n### pg_savior--0.0.1.sql\n\n| Problem: pg_savior is under active dev  \n  \n### pg_savior.c\n\n|\n\n### pg_savior.c\n\n| Problem: unnecessary logging added  \n  \n### pg_savior.control\n\n|\n\n### pg_savior.control\n\n| initial commit  \n  \n## Repository files navigation\n\n# pg_savior\n\npg_savior is a PostgreSQL extension designed to prevent accidental data loss\ndue to non-parameterized DELETE queries without a WHERE clause. It hooks into\nthe query execution path.\n\n## Warning\n\nThe extension is currently under active development. This project is not ready\nfor production yet.\n\n## Features\n\n  * Detect DELETE queries without a WHERE clause\n  * Detect DELETE queries which use index scan\n  * Detects DELETE queries which uses CTE & subqueries\n  * Prevent CREATE INDEX without concurrently\n  * Prevent DROP DATABASE command\n\n## Installation\n\n  1. Clone the repository.\n  2. Navigate to the repository directory.\n  3. Run make to build the extension.\n  4. Run sudo make install to install the extension.\n\n## Demo\n\n    \n    \n    $ psql -U visi -d postgres psql (14.9 (Homebrew)) Type \"help\" for help. postgres=# postgres=# create extension pg_savior; CREATE EXTENSION postgres=# select * from emp; id ---- (0 rows) postgres=# insert into emp values(1); INSERT 0 1 postgres=# delete from emp; INFO: pg_savior: DELETE statement detected INFO: pg_savior: WHERE clause is mandatory for a DELETE statement DELETE 0 postgres=# select * from emp; id ---- 1 (1 row)\n\n## Usage\n\nAfter installing the extension, you can enable it in your PostgreSQL database\nwith the following command:\n\n    \n    \n    CREATE EXTENSION pg_savior;\n\n## Test\n\nThe test suite of pg_savior uses pg_yregres. To run a specific test,\n\n    \n    \n    pg_yregress tests/D0001.yml TAP version 14 1..4 # Initializing instances # Subtest: initialize instance `default` 1..2 ok 1 - create extension pg_savior ok 2 - create table emp ( id int ) ok 1 - initialize instance `default` INFO: pg_savior: ExecutorStart_hook called INFO: pg_savior: ExecutorStart called INFO: pg_savior: queryDesc->sourceText: select oid, typname from pg_type # Done initializing instances ok 2 - D0001: pg_savior: Check if pg_savior is installed # Subtest: D0001: pg_savior: delete without where clause 1..6 ok 1 - insert into emp values (1) ok 2 - insert into emp values (2) ok 3 - insert into emp values (3) ok 4 - select count(*) from emp as count ok 5 - delete from emp ok 6 - select count(*) from emp as count ok 3 - D0001: pg_savior: delete without where clause\n\n## About\n\nA postgres extension to avoid accidental mistakes\n\n### Resources\n\nReadme\n\n### License\n\nApache-2.0 license\n\nActivity\n\n### Stars\n\n31 stars\n\n### Watchers\n\n3 watching\n\n### Forks\n\n2 forks\n\nReport repository\n\n## Releases\n\nNo releases published\n\n## Packages 0\n\nNo packages published\n\n## Contributors 3\n\n  * viggy28\n  * theory David E. Wheeler\n  * ianstanton Ian Stanton\n\n## Languages\n\n  * C 97.1%\n  * Makefile 2.9%\n\n## Footer\n\n\u00a9 2024 GitHub, Inc.\n\nYou can\u2019t perform that action at this time.\n\n", "frontpage": false}
