{"aid": "40015400", "title": "Ask HN: The Day.js Dilemma: How Should We Handle OSS Maintainers Going MIA?", "url": "https://github.com/iamkun/dayjs/pull/2118", "domain": "github.com/iamkun", "votes": 3, "user": "tarwin", "posted_at": "2024-04-12 17:28:12", "comments": 0, "source_title": "Fix issue #2037 - modifying a dayjs instance created with plugin timezone in UTC corrupts it by BePo65 \u00b7 Pull Request #2118 \u00b7 iamkun/dayjs", "source_text": "Fix issue #2037 - modifying a dayjs instance created with plugin timezone in\nUTC corrupts it by BePo65 \u00b7 Pull Request #2118 \u00b7 iamkun/dayjs \u00b7 GitHub\n\nSkip to content\n\nSign in\n\n# Search code, repositories, users, issues, pull requests...\n\nSearch syntax tips\n\nSign in\n\nSign up\n\nYou signed in with another tab or window. Reload to refresh your session. You\nsigned out in another tab or window. Reload to refresh your session. You\nswitched accounts on another tab or window. Reload to refresh your session.\nDismiss alert\n\niamkun / dayjs Public\n\n  * Notifications\n  * Fork 2.2k\n  * Star 45.7k\n\nJump to bottom\n\n# Fix issue #2037 - modifying a dayjs instance created with plugin timezone in\nUTC corrupts it #2118\n\nOpen\n\nBePo65 wants to merge 22 commits into iamkun:dev\n\nfrom BePo65:fix/issue2037\n\nOpen\n\n# Fix issue #2037 - modifying a dayjs instance created with plugin timezone in\nUTC corrupts it #2118\n\nBePo65 wants to merge 22 commits into iamkun:dev from BePo65:fix/issue2037\n\n+886 \u2212187\n\n## Conversation\n\nContributor\n\n###\n\nBePo65 commented Nov 8, 2022 \u2022\n\nUsing 'UTC' (or any timezone with utcOffset 0) will return a false date.\n\nThis pr also fixes the following issues\n\n  * issue urgency-----Etc/GMT0 is Error #2108\n  * issue Modifying (.add(), .subtract(), etc.) a dayjs instance created in UTC corrupts it #2037\n  * issue Unexpected behavior with timezone \"UTC\" #2110\n  * issue After the local timezone is switched to Australia/Sydney, the output of the add method is wrong because winter time is not taken into account #2043\n  * issue .month() resets date property to 1 when in +00:00 UTC timezone #1860\n\nTo fix problems with date strings containing an offset, this solution has to\ndifferentiate between date strings with offset and one without that. To\ndifferentiate a date only string (e.g. yy-mm-dd) from a date string with\nnegative 2-digit offset (hour offset zz, e.g. yy-mm-zz) the changed code\nrequires at least 8 characters before the offset (i.e. yy-mm-dd-zz). This will\nnot solve all possible format strings available by the CustomParseFormat, but\nshould give no problems in real world applications.\n\nMerge branch 'master' of github.com:iamkun/dayjs into dev\n\n4542a1f\n\n###\n\ncodecov bot commented Nov 8, 2022 \u2022\n\n## Codecov Report\n\nPatch coverage: 100.00% and no project coverage change.\n\n> Comparison is base (a947a51) 99.77% compared to head (4cb0ef7) 99.77%.\n\n\u2614 View full report in Codecov by Sentry. \ud83d\udce2 Have feedback on the report? Share\nit here.  \n---  \n  \nMerge branch 'dev' of github.com:iamkun/dayjs into dev\n\ncec0cc0\n\nBePo65 mentioned this pull request Nov 9, 2022\n\nurgency-----Etc/GMT0 is Error #2108\n\nOpen\n\n###\n\nleemoria commented Nov 11, 2022 \u2022\n\nhello,I ask a question, When will the latest version be released ? @iamkun\n@BePo65  \n---  \n  \nBePo65 mentioned this pull request Nov 16, 2022\n\nTimezone 'Europe/London' is not working properly #2126\n\nOpen\n\nBePo65 mentioned this pull request Nov 29, 2022\n\ndayjs object with timezone GMT 0 return (maybe?) wrong date when calling\n.startOf('date') #2144\n\nOpen\n\nBePo65 added 2 commits December 15, 2022 07:13\n\nMerge branch 'dev' of github.com:iamkun/dayjs into dev\n\n4898982\n\nMerge branch 'dev' of github.com:iamkun/dayjs into dev\n\nb64337c\n\nBePo65 mentioned this pull request Jan 8, 2023\n\ndayjs('2023-01-05 03:45:00').tz('Africa/Accra', true).format('YYYY-MM-\nDDTHH:mm:ss.SSSZZ') #2191\n\nOpen\n\nThis was referenced Jan 10, 2023\n\nIncorrect .add() result with timezone plugin #2195\n\nClosed\n\nIncorrect .add(..) / .hour(..) when using timezones on DST #2184\n\nClosed\n\nIncorrect result: 3:00:01 minus 2 second = 1:59:59 depend on env.TZ #2152\n\nOpen\n\nkawanet mentioned this pull request Jan 11, 2023\n\nkeepLocalTime does NOT work correctly at DST #2162\n\nOpen\n\nKronosDev-Pro mentioned this pull request Jan 13, 2023\n\nWrong behaviour of isBefore when using timezones #2182\n\nOpen\n\n###\n\nmichaelklassen02 commented Jan 27, 2023\n\nHi, when is this PR going to be merged? I'm trying to convert a repository\nover to DayJS and we need UTC timezone support to work in order to use it.\n@iamkun @BePo65  \n---  \n  \n###\n\nKestutis commented Jan 28, 2023\n\nWhile waiting on PR to be merged, you can just get fixed timezone plugin and\nuse it directly get it from -\nhttps://github.com/BePo65/dayjs/blob/fix/issue2037/src/plugin/timezone/index.js\nand then import yourself from your project and extend dayjs:\n\n    \n    \n    import timezoneDayjs from \"./local/dayjs/plugin/timezone\"; dayjs.extend(timezoneDayjs);  \n  \n---  \n  \n###\n\nnkeyy0 commented Feb 27, 2023\n\nAny updates related to this PR?  \n---  \n  \nzomars approved these changes Apr 12, 2023\n\nView reviewed changes\n\n###\n\nlitvinovvo commented May 5, 2023 \u2022\n\nWill it be merged any time soon? @iamkun  \n---  \n  \nMerge branch 'dev' of github.com:iamkun/dayjs into dev\n\n2e886c2\n\n###\n\nzxd65885152 commented Aug 9, 2023\n\nhello, is there any updates with this PR?  \n---  \n  \n###\n\nateszki commented Aug 29, 2023\n\nI think that with this changes it is safe to remove this previous change #1212  \n---  \n  \nantoniovogrin reviewed Sep 16, 2023\n\nView reviewed changes\n\nantoniovogrin reviewed Sep 18, 2023\n\nView reviewed changes\n\nMerge branch 'dev' of github.com:iamkun/dayjs into dev\n\nef1e96e\n\niamkun added the \ud83d\udea8 High Priority label Sep 20, 2023\n\nBePo65 and others added 3 commits September 23, 2023 16:28\n\nMerge branch 'dev' of github.com:iamkun/dayjs into dev\n\nbbb28a6\n\nchore(release): 1.11.9 [skip ci]\n\n39308c9\n\n    \n    \n    ## [1.11.9](iamkun/dayjs@v1.11.8...v1.11.9) (2023-07-01) ### Bug Fixes * Add null to min and max plugin return type ([iamkun#2355](iamkun#2355)) ([62d9042](iamkun@62d9042)) * check if null passed to objectSupport parser ([iamkun#2175](iamkun#2175)) ([013968f](iamkun@013968f)) * dayjs.diff improve performance ([iamkun#2244](iamkun#2244)) ([33c80e1](iamkun@33c80e1)) * dayjs(null) throws error, not return dayjs object as invalid date ([iamkun#2334](iamkun#2334)) ([c79e2f5](iamkun@c79e2f5)) * objectSupport plugin causes an error when null is passed to dayjs function (closes [iamkun#2277](iamkun#2277)) ([iamkun#2342](iamkun#2342)) ([89bf31c](iamkun@89bf31c)) * Optimize format method ([iamkun#2313](iamkun#2313)) ([1fe1b1d](iamkun@1fe1b1d)) * update Duration plugin add/subtract take into account days in month ([iamkun#2337](iamkun#2337)) ([3b1060f](iamkun@3b1060f)) * update MinMax plugin 1. ignore the 'null' in args 2. return the only one arg ([iamkun#2330](iamkun#2330)) ([3c2c6ee](iamkun@3c2c6ee))\n\nchore(release): 1.11.10 [skip ci]\n\n7e2c794\n\n    \n    \n    ## [1.11.10](iamkun/dayjs@v1.11.9...v1.11.10) (2023-09-19) ### Bug Fixes * Add Korean Day of Month with ordinal ([iamkun#2395](iamkun#2395)) ([dd55ee2](iamkun@dd55ee2)) * change back fa locale to the Gregorian calendar equivalent ([iamkun#2411](iamkun#2411)) ([95e9458](iamkun@95e9458)) * duration plugin - MILLISECONDS_A_MONTH const calculation ([iamkun#2362](iamkun#2362)) ([f0a0b54](iamkun@f0a0b54)) * duration plugin getter get result 0 instead of undefined ([iamkun#2369](iamkun#2369)) ([061aa7e](iamkun@061aa7e)) * fix isDayjs check logic ([iamkun#2383](iamkun#2383)) ([5f3f878](iamkun@5f3f878)) * fix timezone plugin to get correct locale setting ([iamkun#2420](iamkun#2420)) ([4f45012](iamkun@4f45012)) * **locale:** add meridiem in `ar` locale ([iamkun#2418](iamkun#2418)) ([361be5c](iamkun@361be5c)) * round durations to millisecond precision for ISO string ([iamkun#2367](iamkun#2367)) ([890a17a](iamkun@890a17a)) * sub-second precisions need to be rounded at the seconds field to avoid adding floats ([iamkun#2377](iamkun#2377)) ([a9d7d03](iamkun@a9d7d03)) * update $x logic to avoid plugin error ([iamkun#2429](iamkun#2429)) ([2254635](iamkun@2254635)) * Update Slovenian locale for relative time ([iamkun#2396](iamkun#2396)) ([5470a15](iamkun@5470a15)) * update uzbek language translation ([iamkun#2327](iamkun#2327)) ([0a91056](iamkun@0a91056))\n\nBePo65 added 13 commits September 23, 2023 17:30\n\nrefactor: remove duplicate empty lines\n\nd3cfe79\n\nbuild: use npx to run eslint\n\n1b6dafc\n\ntest: fix duplicate tests / test names\n\n093cf9c\n\ntest: suppress console.warn when testing moment with illegal value\n\nc194751\n\ntest: split test 'parse timestamp' for 'timezone' for easier debugging\n\n9561c98\n\ntest: add tests for issue 2037 and issue iamkun#2110 in plugin/timezo...\n\ne0af8d9\n\n    \n    \n    ...ne.test.js\n\ntest: increase test coverage of timezone to 100%\n\nea7bf75\n\n    \n    \n    Removed default value for input parameter 'options', as getDateTimeFormat is never called without an options parameter; so this case cannot be tested.\n\nfix: handling of UTC timezones in Dayjs.tz\n\nf541369\n\nfix: handling of input strings with offset in dayjs.tz\n\n96b49fd\n\ntest: add tests for timezone gmt (utcOffset 0)\n\nf4e9819\n\ntest: add tests for issue 2037 and issue iamkun#2110 in plugin/timezo...\n\n1af5a59\n\n    \n    \n    ...ne.test.js\n\ntest: add tests for timezone name and tz.offsetName\n\n086c7f8\n\n    \n    \n    'timezone name' is an internal field of dayjs (dayjs.$x.$timezone, while 'tz.offsetName' is \"official\" name of the timezone returned by Intl.DateTimeFormat\n\ntest: fix MockDate linter error\n\n4cb0ef7\n\nBePo65 force-pushed the fix/issue2037 branch from 905967d to 4cb0ef7 Compare\nSeptember 23, 2023 15:35\n\nThis was referenced Oct 19, 2023\n\nstartOf not working when the timezone is set to UTC+0:00 #2373\n\nOpen\n\n[pickers] Timezone management fails with dayjs id the timezone is UTC+00:00\nmui/mui-x#9653\n\nOpen\n\n###\n\nCheewbacca commented Oct 23, 2023\n\nAny updates ?  \n---  \n  \n###\n\nJugaruRobert commented Nov 23, 2023\n\nAny updates about merging this? @iamkun  \n---  \n  \nmichelengelen mentioned this pull request Jan 24, 2024\n\n[data grid] dateTime column how to show date/time for another timezone\nmui/mui-x#11804\n\nClosed\n\n###\n\njonah-ullman commented Jan 30, 2024\n\nHey there @iamkun, any updates on this? Thanks!  \n---  \n  \nmichelengelen mentioned this pull request Feb 6, 2024\n\n[pickerts] not correctly setting the date time using dayjs with timezone\nmui/mui-x#11955\n\nClosed\n\n###\n\nandrashee commented Feb 29, 2024\n\nWhat is blocking this PR to be merged @BePo65 @zomars? Having this fixed is\ncrucial when working with tz and dayjs.  \n---  \n  \nContributor Author\n\n###\n\nBePo65 commented Feb 29, 2024\n\nwaiting for @iamkun - I think this repository is dead. I am thinking about a\nfork that will merge all the important open pr.  \n---  \n  \nSign up for free to join this conversation on GitHub. Already have an account?\nSign in to comment\n\nLabels\n\n\ud83d\udea8 High Priority\n\n16 participants\n\nAdd this suggestion to a batch that can be applied as a single commit. This\nsuggestion is invalid because no changes were made to the code. Suggestions\ncannot be applied while the pull request is closed. Suggestions cannot be\napplied while viewing a subset of changes. Only one suggestion per line can be\napplied in a batch. Add this suggestion to a batch that can be applied as a\nsingle commit. Applying suggestions on deleted lines is not supported. You\nmust change the existing code in this line in order to create a valid\nsuggestion. Outdated suggestions cannot be applied. This suggestion has been\napplied or marked resolved. Suggestions cannot be applied from pending\nreviews. Suggestions cannot be applied on multi-line comments. Suggestions\ncannot be applied while the pull request is queued to merge. Suggestion cannot\nbe applied right now. Please check back later.\n\n## Footer\n\n\u00a9 2024 GitHub, Inc.\n\nYou can\u2019t perform that action at this time.\n\n", "frontpage": false}
