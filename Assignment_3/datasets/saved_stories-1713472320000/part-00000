{"aid": "40076674", "title": "Moving 670 Network Connections", "url": "https://backblazeprod.wpenginepowered.com/blog/moving-670-network-connections/", "domain": "wpenginepowered.com", "votes": 2, "user": "ingve", "posted_at": "2024-04-18 14:29:56", "comments": 0, "source_title": "Moving 670 Network Connections", "source_text": "Moving 670 Network Connections\n\nBLOG\n\nAll\n\n  * All\n  * Cloud Storage\n\nTips, stories, insights, investigations, and how-tos about cloud storage.\n\n  * Backing Up\n\nTopics related to backing up data, including backup strategies and techniques,\nand technical details and insights about backup.\n\n  * Business Lab\n\nBootstrapping, start-up tales and challenges, marketing mayhem, and more.\n\n  * Backblaze Bits\n\nTopics related to Backblaze products and releases, as well as Backblaze new\nhires, job postings, things around the office, irreverent humor, and more.\n\n  * Tech Lab\n\nArticles that explore our technical content more deeply, and are often geared\ntowards our developer audience.\n\n  * Partner News\n\nYour space to read up on our latest partnership announcements, partner\ncontent, and more.\n\nShares\n\nShare\n\nTweet\n\nEmail\n\nShare\n\nShare\n\nShare\n\nShare\n\n# Moving 670 Network Connections\n\nApril 18, 2024 byJack Fults // Leave a comment\n\n#### Editor\u2019s Note\n\nWe\u2019re constantly upgrading our storage cloud, but we don\u2019t always have ways to\ntangibly show what multi-exabyte infrastructure looks like. When data center\nmanager, Jack Fults, shared photos from a recent network switch migration,\nthough, it felt like exactly the kind of thing that makes The CloudTM real in\na physical, visual sense. We figured it was a good opportunity to dig into\nsome of our more recent upgrades.\n\nIf your parents ever tried to enforce restrictions on internet time, and in\nresponse, you hardwired a secret 120ft Ethernet cable from the router in your\nbasement through the rafters and up into your room so you could game whenever\nyou wanted, this story is for you.\n\nReplacing 670 network switches in a data center is kind of like that, times\n1,000. And that\u2019s exactly what we did in our Sacramento data center recently.\n\n## Hi, I\u2019m Jack\n\nI\u2019m a data center manager here at Backblaze, and I\u2019m in charge of making sure\nour hardware can meet our production needs, interfacing with the data center\nownership, and generally keeping the building running, all in service of\ndelivering easy cloud storage and backup services to our customers. I lead an\nintrepid team of data center technicians who deserve a ton of kudos for making\nthis project happen as well as our entire Cloud Operations team.\n\nHere I am taking a swim in a bunch of decommissioned cable from an older\nmigration of cat 5e out of our racks. Do not be alarmed by the Spaghetti\nMonster\u2014these cables aren\u2019t connected to anything, and they promptly made\ntheir way to a recycling facility.\n\n## Why Did We Need to Move 670 Network Connections?\n\nWe\u2019re constantly looking for ways to make our infrastructure better, faster,\nand smarter, and in that effort, we wanted to upgrade to new network switches.\nThe new switches would allow us to consolidate connections and mitigate any\npotential future failures. We have plenty of redundancy and protocols in place\nin the event that happens, but it was a risk we knew we\u2019d be wise to get ahead\nof as we continued to grow our data under management.\n\nExample of the old cabling connected to the Dell switches. Pretty much\neverything in this cabinet has been replaced, except for the aggregate switch\nproviding uplinks to our access switches.\n\n## Switch Migration Challenges\n\nIn order to make the move, we faced a few challenges:\n\n  * Minimizing network loss: How do we rip out all those switches without our Vaults being down for hours and hours?\n  * Space for new cabling: In order to minimize network loss, we needed the new cabling in place and connected to the new switches before a cutover, but our original network cabinets were on the smaller side and full of existing cabling.\n  * Space for new switches: We wanted to reuse the same rack units for the new Arista switches, so we had to figure out a method that allowed us to slide the old switches straight forward, out of the cabinet, and slide the new switches straight in.\n  * Time: Every day we didn\u2019t have the new switches in place was a day we risked a lock up that would take time away from our ability to roll out standard deployments and prepare for production demands.\n\n## Here\u2019s How We Did It\n\nRacking new switches in cabinets that are already fully populated isn\u2019t ideal,\nbut it is totally doable with a little planning (okay, a lot of planning).\nIt\u2019s a good thing I love nothing more than a good Google sheet, and believe me\nwe tracked everything down to the length of the cables (3,272ft to be exact,\nbut more on that later). Here\u2019s a breakdown of our process:\n\n  1. Put up a temporary, transfer switch in the cabinet and move the connections there. Ports didn\u2019t matter, since it was just temporary, so that sped things up a bit.\n  2. Decommission the old switch, pulling the power cabling and unbolting it from the rack.\n  3. Ratchet our cables up using a makeshift pulley system in order to pull the switches straight out from the rack and set them aside.\n\nCarefully hoisting up the cabling with our makeshift Velcro pulley systems to\nallow the old switches to come out, and the new ones go in. Although this\nmight look a little jury-rigged, it greatly helped us support the weight of\nthe production management cables and hold them out of the way.\n\n  4. Rack the new Arista switch and connect it to our aggregate switch which breaks out connections to all of the access switches.\n  5. Configure the new switch \u2013 many thanks go to our Network Engineering team for their work on this part.\n  6. Finally, move the connections from the temporary switch to the new Arista switch.\n\nOne of the first 2U switches to start receiving new cabling.\n\nEach 1U Dell had 48 connections, which handled two Backblaze Vaults. We were\nable to upgrade to 2U switches with the new Aristas, which each had 96\nconnections, fitting four Backblaze Vaults plus 16 core servers. So, every\ntime we moved to the next four vaults, we\u2019d go through this process until we\nwere through the network switch migration for 27 Vaults plus core servers,\ncomprising the 670 network connections.\n\nJustin Whisenant, our senior DC tech, realizing that this is the last cable to\ncutover before all connections have been swapped.\n\nUsing the transfer switch allowed us to decommission the old switch then rack\nand configure the new switch so that we only lost a second or two of network\nconnectivity as one of the DC techs moved the connection. That was one of the\nthings we had to be very planful about\u2014making sure the Vault would remain\navailable, with the exception of one server that would be down for a split\nsecond during the swap. Then, our DC techs would confirm that connectivity was\nback up before moving on to the next server in the Vault.\n\n## Oh, And We Also Ran New Cables\n\nWe ran into a wrinkle early on in the project. We had two cabinets side by\nside where the switches are located, so sometimes we\u2019d rack the temporary\nswitch in one and the new Arista switch in the other. Some of the old cables\nweren\u2019t long enough to reach the new switches. There\u2019s not much else you can\ndo at that point but run new cables, so we decided to replace all of the\ncables wholesale\u20143,272ft of new cable went in.\n\nWe had to fine-tune our plans even more to balance decommissioning with\nracking the new switches in order to make room for the new cables, but it also\nended up solving another issue we hadn\u2019t even set out to address. It allowed\nus to eliminate a lot of slack from cables that were too long. Over time, with\nthe amount of cables we had, the slack made it difficult to work in the racks,\nso we were happy to see that go away.\n\nThere\u2019s still decom and cable dressing to do, but it looks so much better.\n\nWhile we still have some cable management and decommissioning to be done,\nmigrating to the Arista switches was the mission critical piece to mitigate\nour risk and plan for ongoing improvements.\n\nAs a data center manager, we get to work on the side of tech that takes the\nabstract internet and makes it tangible, and that\u2019s pretty cool. It can be\nhard for people to visualize The Cloud, but it\u2019s made up of cables and racks\nand network switches just like these. Even though my mom loves to bring up\nthat secret Ethernet cable story at family events, I think she\u2019s pretty happy\nthat it led that mischievous kid to a project like this.\n\n## One Project Among Many\n\nWhile not every project has great pictures to go along with it, we\u2019re always\nupgrading our systems for performance, security, and reliability. Some other\nprojects we\u2019re completed in the last few months include reconfiguring much of\nour space to make it more efficient and ready for enterprise-level hardware,\nmoving our physical media operations, and decommissioning 4TB Vaults as we\nmigrate them to larger Vaults with larger drives. Stay tuned for a longer post\nabout that from our very own Andy Klein.\n\nprint\n\nPublished April 18, 2024\n\nCategorized as Cloud Storage, Featured Tagged B2Cloud\n\n## About Jack Fults\n\nJack is a Data Center Manager at Backblaze where he works with a team of data\ncenter techs to maintain our equipment. With over six years of experience\nworking in our data centers, he strives to develop and execute plans to\nreconfigure space efficiently to best serve our customers. Jack is an Eagle\nScout who has survived three of the Boy Scouts of America's high adventure\ncamps\u2014Philmont, Sea Base and Northern Tier\u2014which earned him a Triple Crown\naward. He also loves cars... Can't forget the cars.\n\n## Related Posts\n\n### Automate Your Data Workflows With Backblaze B2 Event Notifications\n\nApril 15, 2024\n\n### AI 101: What Is Model Serving?\n\nApril 11, 2024\n\n### Join Backblaze Tech Talks at NAB 24\n\nApril 9, 2024\n\n\u00a9 2024 Backblaze\n\nA Publicly Traded Company\n\n(\n\nBLZE\n\n)\n\nTerms & PoliciesPrivacyContact\n\nTop\n\n### Privacy Preference Center\n\nWhen you visit any website, it may store or retrieve information on your\nbrowser, mostly in the form of cookies. This information might be about you,\nyour preferences or your device and is mostly used to make the site work as\nyou expect it to. The information does not usually directly identify you, but\nit can give you a more personalized web experience. Because we respect your\nright to privacy, you can choose not to allow some types of cookies. Click on\nthe different category headings to find out more and change our default\nsettings. However, blocking some types of cookies may impact your experience\nof the site and the services we are able to offer. More information\n\n### Manage Consent Preferences\n\n#### Optional Cookies\n\n  * ###### Targeting Cookies\n\nThese cookies may be set through our site by our advertising partners. They\nmay be used by those companies to build a profile of your interests and show\nyou relevant adverts on other sites. They do not store directly personal\ninformation, but are based on uniquely identifying your browser and internet\ndevice. If you do not allow these cookies, you will experience less targeted\nadvertising.\n\nCookies Details\n\n#### Required Cookies\n\n  * ###### Performance Cookies\n\nThese cookies allow us to count visits and traffic sources so we can measure\nand improve the performance of our site. They help us to know which pages are\nthe most and least popular and see how visitors move around the site. All\ninformation these cookies collect is aggregated and therefore anonymous. If\nyou do not allow these cookies we will not know when you have visited our\nsite, and will not be able to monitor its performance.\n\n  * ###### Strictly Necessary Cookies\n\nAlways Active\n\nThese cookies are necessary for the website to function and cannot be switched\noff in our systems. They are usually only set in response to actions made by\nyou which amount to a request for services, such as setting your privacy\npreferences, logging in or filling in forms. You can set your browser to block\nor alert you about these cookies, but some parts of the site will not then\nwork. These cookies do not store any personally identifiable information.\n\n  * ###### Functional Cookies\n\nThese cookies enable the website to provide enhanced functionality and\npersonalisation. They may be set by us or by third party providers whose\nservices we have added to our pages. If you do not allow these cookies then\nsome or all of these services may not function properly.\n\nCookies Details\n\nBack\n\n### Performance Cookies\n\nClear Filters\n\nConsent Leg.Interest\n\nAll Consent Allowed\n\n  * ### 33Across\n\n#### host description\n\n#### View Cookies\n\n    * Name\n\ncookie name\n\n  * ### 33Across\n\nView Privacy Notice\n\n3 Purposes\n\nConsent Purposes\n\nLocation Based Ads\n\nConsent Allowed\n\nLegitimate Interest Purposes\n\nPersonalize\n\nRequire Opt-Out\n\nSpecial Purposes\n\nLocation Based Ads\n\nFeatures\n\nLocation Based Ads\n\nSpecial Features\n\nLocation Based Ads\n\nBy clicking \u201cAccept All Cookies\u201d, you agree to the storing of cookies on your\ndevice to enhance site navigation, analyze site usage, and assist in our\nmarketing efforts. View ourCookie Policy\n\n", "frontpage": false}
