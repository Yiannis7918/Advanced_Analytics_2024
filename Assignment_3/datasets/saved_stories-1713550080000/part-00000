{"aid": "40085751", "title": "Pocketbase v0.20.5 fork for implementing PostgreSQL interface", "url": "https://github.com/AlperRehaYAZGAN/postgresbase", "domain": "github.com/alperrehayazgan", "votes": 1, "user": "maxbaines", "posted_at": "2024-04-19 12:05:10", "comments": 0, "source_title": "GitHub - AlperRehaYAZGAN/postgresbase: Pocketbase v0.20.5 fork for implementing PostgreSQL interface. (using pocketbase/dbx). (\u23f3Building...)", "source_text": "GitHub - AlperRehaYAZGAN/postgresbase: Pocketbase v0.20.5 fork for\nimplementing PostgreSQL interface. (using pocketbase/dbx). (\u23f3Building...)\n\nSkip to content\n\nSign in\n\n# Search code, repositories, users, issues, pull requests...\n\nSearch syntax tips\n\nSign in\n\nSign up\n\nYou signed in with another tab or window. Reload to refresh your session. You\nsigned out in another tab or window. Reload to refresh your session. You\nswitched accounts on another tab or window. Reload to refresh your session.\nDismiss alert\n\nAlperRehaYAZGAN / postgresbase Public\n\nforked from pocketbase/pocketbase\n\n  * Notifications\n  * Fork 4\n  * Star 19\n\nPocketbase v0.20.5 fork for implementing PostgreSQL interface. (using\npocketbase/dbx). (\u23f3Building...)\n\n### License\n\nMIT license\n\n19 stars 1.5k forks Branches Tags Activity\n\nStar\n\nNotifications\n\n# AlperRehaYAZGAN/postgresbase\n\nThis commit does not belong to any branch on this repository, and may belong\nto a fork outside of the repository.\n\n1 Branch\n\n5 Tags\n\nThis branch is 13 commits ahead of, 147 commits behind\npocketbase/pocketbase:master.\n\n## Folders and files\n\nName| Name| Last commit message| Last commit date  \n---|---|---|---  \n  \n## Latest commit\n\nAlperRehaYAZGANjwt claims verified,verified_at claims added.Feb 27,\n2024526108d \u00b7 Feb 27, 2024Feb 27, 2024\n\n## History\n\n1,237 Commits  \n  \n### .github\n\n|\n\n### .github\n\n| fix the node version as latest seems to cause some issue with sass| Oct 24,\n2023  \n  \n### apis\n\n|\n\n### apis\n\n| module name changed to due unsupport of package aliasing| Feb 1, 2024  \n  \n### cmd\n\n|\n\n### cmd\n\n| module name changed to due unsupport of package aliasing| Feb 1, 2024  \n  \n### core\n\n|\n\n### core\n\n| module name changed to due unsupport of package aliasing| Feb 1, 2024  \n  \n### daos\n\n|\n\n### daos\n\n| module name changed to due unsupport of package aliasing| Feb 1, 2024  \n  \n### examples/base\n\n|\n\n### examples/base\n\n| module name changed to due unsupport of package aliasing| Feb 1, 2024  \n  \n### forms\n\n|\n\n### forms\n\n| oauth redirect userid exact len 15 err fix min-max revised| Feb 10, 2024  \n  \n### keys\n\n|\n\n### keys\n\n| jwt rsa priv-pub keypair from env var support added| Jan 23, 2024  \n  \n### mails\n\n|\n\n### mails\n\n| module name changed to due unsupport of package aliasing| Feb 1, 2024  \n  \n### migrations\n\n|\n\n### migrations\n\n| module name changed to due unsupport of package aliasing| Feb 1, 2024  \n  \n### models\n\n|\n\n### models\n\n| oauth redirect userid exact len 15 err fix min-max revised| Feb 10, 2024  \n  \n### plugins\n\n|\n\n### plugins\n\n| module name changed to due unsupport of package aliasing| Feb 1, 2024  \n  \n### resolvers\n\n|\n\n### resolvers\n\n| module name changed to due unsupport of package aliasing| Feb 1, 2024  \n  \n### tests\n\n|\n\n### tests\n\n| module name changed to due unsupport of package aliasing| Feb 1, 2024  \n  \n### tokens\n\n|\n\n### tokens\n\n| jwt claims verified,verified_at claims added.| Feb 27, 2024  \n  \n### tools\n\n|\n\n### tools\n\n| create index back tick err due to postgres fix| Feb 11, 2024  \n  \n### ui\n\n|\n\n### ui\n\n| postgres conn added. Sqlite3 scripts migrated.| Jan 15, 2024  \n  \n### volumes\n\n|\n\n### volumes\n\n| postgres conn added. Sqlite3 scripts migrated.| Jan 15, 2024  \n  \n### .dockerignore\n\n|\n\n### .dockerignore\n\n| docker support added.| Jan 24, 2024  \n  \n### .gitignore\n\n|\n\n### .gitignore\n\n| jwt rsa priv-pub keypair from env var support added| Jan 23, 2024  \n  \n### .goreleaser.yaml\n\n|\n\n### .goreleaser.yaml\n\n| postgres conn added. Sqlite3 scripts migrated.| Jan 15, 2024  \n  \n### CHANGELOG.md\n\n|\n\n### CHANGELOG.md\n\n| [pocketbase#4079] fixed popup searchbar css styles to prevent hiding ...|\nJan 4, 2024  \n  \n### CHANGELOG_8_15.md\n\n|\n\n### CHANGELOG_8_15.md\n\n| split changelog in chunks| Dec 16, 2023  \n  \n### CONTRIBUTING.md\n\n|\n\n### CONTRIBUTING.md\n\n| [pocketbase#3531] updated README.md and CONTRIBUTING.md formatting| Oct 16,\n2023  \n  \n### Dockerfile\n\n|\n\n### Dockerfile\n\n| dockerfile updated due to run exec err| Jan 25, 2024  \n  \n### LICENSE.md\n\n|\n\n### LICENSE.md\n\n| filter enhancements| Jan 7, 2023  \n  \n### Makefile\n\n|\n\n### Makefile\n\n| updated cron jsvm bindings and generated types| Jul 16, 2023  \n  \n### README.md\n\n|\n\n### README.md\n\n| v9.20.6: bcrypt salt cost from env var support added| Feb 6, 2024  \n  \n### docker-compose.yaml\n\n|\n\n### docker-compose.yaml\n\n| postgres conn added. Sqlite3 scripts migrated.| Jan 15, 2024  \n  \n### go.mod\n\n|\n\n### go.mod\n\n| module name changed to due unsupport of package aliasing| Feb 1, 2024  \n  \n### go.sum\n\n|\n\n### go.sum\n\n| postgres conn added. Sqlite3 scripts migrated.| Jan 15, 2024  \n  \n### golangci.yml\n\n|\n\n### golangci.yml\n\n| updated ui/dist, go deps, docs and fixed some typos| Dec 10, 2023  \n  \n### pocketbase.go\n\n|\n\n### pocketbase.go\n\n| module name changed to due unsupport of package aliasing| Feb 1, 2024  \n  \n### pocketbase_test.go\n\n|\n\n### pocketbase_test.go\n\n| [pocketbase#3877] fixed test messages typo| Dec 4, 2023  \n  \n## Repository files navigation\n\n## Fork Explanation \u2764\ufe0f Pocketbase\n\nPocketbase Documentation\n\n> Important Note: Go modules does not support module aliasing. So we changed\n> the module name to \"github.com/pocketbase/pocketbase\" to\n> \"github.com/AlperRehaYAZGAN/postgresbase\" in go.mod file and all imported\n> package prefixes. You could change it back to\n> \"github.com/pocketbase/pocketbase\" if you want to customize the project.\n\nPocketbase is a great product and very efficient for small-mid projects. It\nhas no any additional setup for any other features and it is very easy to use\non a single server.\n\nIn our use-case we really need to use postgres as a main database and operate\nit manually. Also we love what Pocketbase does with CRUD operation and RBAC\nimplementations via simple notations. So we want to use it. Thus we forked it\nand make it compatible with postgres using its own library called\n\"pocketbase/dbx\".\n\nWe are still working on it and we will update the documentation as soon as we\nfinish the project.\n\nWe just added a following features additinonally to the Pocketbase:\n\n  * We use Twitter Snowflake for ID generation. Every table ID is generated by postgres function as data type varchar(32)\n  * We converted created and updated columns to postgres native date types TIMESTAMPTZ to support native date operations\n  * We write json functions for postgres in migration files to support json equivalent operations from Pocketbase.\n  * We add support RSA256 JWT Public Private Keys while encoding and decoding token. In our case we need to implement Pocketbase to our existing project with RSA keypair. Currently (Pocketbase v0.20.5) supports symmetric encoding only and we extend it.\n  * We add Dockerfile and docker-compose.yml for building and running the project.\n\n## TODO\n\n  * OAuth2 challenge and state keys stored in cache on single instance. We need to make it remote cache or database to support oauth2 on deployed multiple instances.\n  * Jwt Extra Claims support on after login and register.\n\n## Usage\n\nYou can easily fork and setup the project.\n\n    \n    \n    # clone and download libraries git clone https://github.com/AlperRehaYAZGAN/postgresbase cd postgresbase go mod download # docker-compose has 3 service for test pocketbase all features: # 1. Postgres: runs on port 5432 # 1. postgres://user:pass@localhost/logs?sslmode=disable # 2. minio: UI runs on port 9001 and API on 9000 (minio123:minio123) # 2. s3://minio123:minio123@localhost:9000/public # (dont forget to manually create bucket called \"public\" via web ui to establish s3 connection from pocketbase) # 3. mailhog: port: SMTP-1025 and UI-8025 # 3. smtp://localhost:1025 - http://localhost:8025 docker-compose up -d # before run the project, you need to create and set RSA Public key pair for JWT before run the application. # you can use following command to generate RSA key pair openssl genrsa -out ./keys/private.pem 2048 openssl rsa -in ./keys/private.pem -outform PEM -pubout -out ./keys/public.pem # after generating keys, you can set as environment variables export JWT_PRIVATE_KEY=$(cat ./keys/private.pem) export JWT_PUBLIC_KEY=$(cat ./keys/public.pem) export CGO_ENABLED=0 exprot LOGS_DATABASE=\"postgresql://user:pass@localhost/logs?sslmode=disable\" export DATABASE=\"postgresql://user:pass@localhost/postgres?sslmode=disable\" # optional ENV_VARS export BCRYPT_COST=10 # default is 12 # export is success you can run the project \u2705 go run -tags pq ./examples/base serve\n\n### Docker\n\n    \n    \n    # build docker image docker buildx build --platform linux/amd64 -t <your-name>/postgresbase:1.0.0 . # before running application generate RSA256 public-private key pair for jwt signing # you can use following command to generate RSA key pair openssl genrsa -out ./keys/private.pem 2048 openssl rsa -in ./keys/private.pem -outform PEM -pubout -out ./keys/public.pem # run docker image docker run -d --name postgresbase \\ -p 8090:8090 \\ -e LOGS_DATABASE=\"postgresql://user:pass@<postgres-ip>:5432/logs?sslmode=disable\" \\ -e DATABASE=\"postgresql://user:pass@<postgres-ip>:5432/postgres?sslmode=disable\" \\ -e JWT_PRIVATE_KEY=\"$(cat $PWD/keys/private.pem)\" \\ -e JWT_PUBLIC_KEY=\"$(cat $PWD/keys/public.pem)\" \\ <your-name>/postgresbase:1.0.0\n\n## Extend Pocketbase (Postgresbase)\n\nWe just changed the database connection and added some features to Pocketbase.\nSo you can use all features of current Pocketbase v0.25.0. You could check the\nPocketbase Documentation for more information. You can easily use Pocketbase\nas a library and extend it like shown below.\n\n  * Install library\n\n    \n    \n    go get github.com/AlperRehaYAZGAN/postgresbase # go version v1.21 or higher\n\n  * You can use everything like Pocketbase but only change the import path\n\n    \n    \n    package main import ( \"log\" \"os\" \"time\" pocketbase \"github.com/AlperRehaYAZGAN/postgresbase\" // ! Just change the import path \"github.com/AlperRehaYAZGAN/postgresbase/core\" // ! Just change the import path ) func main() { app := pocketbase.New() // TODO: Add your own plugins, logic or any pocketbase supported features // ... if err := app.Start(); err != nil { log.Fatal(err) } }\n\n  * You could run app with following command:\n\n    \n    \n    # before running application generate RSA256 public-private key pair for jwt signing # you can use following command to generate RSA key pair openssl genrsa -out ./keys/private.pem 2048 openssl rsa -in ./keys/private.pem -outform PEM -pubout -out ./keys/public.pem # set required environment variables export JWT_PRIVATE_KEY=$(cat ./keys/private.pem) export JWT_PUBLIC_KEY=$(cat ./keys/public.pem) export CGO_ENABLED=0 export LOGS_DATABASE=\"postgresql://user:pass@localhost/logs?sslmode=disable\" export DATABASE=\"postgresql://user:pass@localhost/postgres?sslmode=disable\" # optional ENV_VARS export BCRYPT_COST=10 # default is 12 # run the application go run -tags pq main.go serve --http=0.0.0.0:8090\n\n## About\n\nPocketbase v0.20.5 fork for implementing PostgreSQL interface. (using\npocketbase/dbx). (\u23f3Building...)\n\n### Topics\n\npostgres pocketbase pocketbase-postgres\n\n### Resources\n\nReadme\n\n### License\n\nMIT license\n\n### Security policy\n\nSecurity policy\n\nActivity\n\n### Stars\n\n19 stars\n\n### Watchers\n\n1 watching\n\n### Forks\n\n4 forks\n\nReport repository\n\n## Releases 4\n\nv0.20.5 Latest\n\nFeb 2, 2024\n\n\\+ 3 releases\n\n## Packages 0\n\nNo packages published\n\n## Languages\n\n  * Go 65.0%\n  * Svelte 19.7%\n  * SCSS 7.9%\n  * CSS 4.3%\n  * JavaScript 3.0%\n  * HTML 0.1%\n\n## Footer\n\n\u00a9 2024 GitHub, Inc.\n\nYou can\u2019t perform that action at this time.\n\n", "frontpage": false}
