{"aid": "40012712", "title": "Unauthenticated, RCE vulnerability in Palo Alto firewalls, exploits in the wild", "url": "https://security.paloaltonetworks.com/CVE-2024-3400", "domain": "paloaltonetworks.com", "votes": 22, "user": "billyhoffman", "posted_at": "2024-04-12 13:38:46", "comments": 4, "source_title": "CVE-2024-3400 PAN-OS: OS Command Injection Vulnerability in GlobalProtect Gateway", "source_text": "CVE-2024-3400 PAN-OS: OS Command Injection Vulnerability in GlobalProtect\nGateway\n\nPalo Alto Networks Security Advisories / CVE-2024-3400\n\n## CVE-2024-3400 PAN-OS: OS Command Injection Vulnerability in GlobalProtect\nGateway\n\nSeverity 10 \u00b7 CRITICAL\n\nUrgency HIGHEST\n\nResponse Effort MODERATE\n\nRecovery USER\n\nValue Density CONCENTRATED\n\nAttack Vector NETWORK\n\nAttack Complexity LOW\n\nAttack Requirements NONE\n\nAutomatable YES\n\nUser Interaction NONE\n\nProduct Confidentiality HIGH\n\nProduct Integrity HIGH\n\nProduct Availability HIGH\n\nPrivileges Required NONE\n\nSubsequent Confidentiality HIGH\n\nSubsequent Integrity HIGH\n\nSubsequent Availability HIGH\n\nNVD JSON\n\nPublished 2024-04-12\n\nUpdated 2024-04-12\n\nReference PAN-252214\n\nDiscovered in production use\n\n### Description\n\nA command injection vulnerability in the GlobalProtect feature of Palo Alto\nNetworks PAN-OS software for specific PAN-OS versions and distinct feature\nconfigurations may enable an unauthenticated attacker to execute arbitrary\ncode with root privileges on the firewall.\n\nFixes for PAN-OS 10.2, PAN-OS 11.0, and PAN-OS 11.1 are in development and are\nexpected to be released by April 14, 2024. Cloud NGFW, Panorama appliances,\nand Prisma Access are not impacted by this vulnerability. All other versions\nof PAN-OS are also not impacted.\n\n### Product Status\n\nVersions| Affected| Unaffected  \n---|---|---  \nCloud NGFW| None| All  \nPAN-OS 11.1| < 11.1.2-h3| >= 11.1.2-h3 (ETA: By 4/14)  \nPAN-OS 11.0| < 11.0.4-h1| >= 11.0.4-h1 (ETA: By 4/14)  \nPAN-OS 10.2| < 10.2.9-h1| >= 10.2.9-h1 (ETA: By 4/14)  \nPAN-OS 10.1| None| All  \nPAN-OS 10.0| None| All  \nPAN-OS 9.1| None| All  \nPAN-OS 9.0| None| All  \nPrisma Access| None| All  \n  \n### Required Configuration for Exposure\n\nThis issue is applicable only to PAN-OS 10.2, PAN-OS 11.0, and PAN-OS 11.1\nfirewalls with the configurations for both GlobalProtect gateway and device\ntelemetry enabled.\n\nYou can verify whether you have a GlobalProtect gateway configured by checking\nfor entries in your firewall web interface (Network > GlobalProtect >\nGateways) and verify whether you have device telemetry enabled by checking\nyour firewall web interface (Device > Setup > Telemetry).\n\n### Severity: CRITICAL\n\nCVSSv4.0 Base Score: 10\n(CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:H/SI:H/SA:H/AU:Y/R:U/V:C/RE:M/U:Red)\n\n### Exploitation Status\n\nPalo Alto Networks is aware of a limited number of attacks that leverage the\nexploitation of this vulnerability.\n\n### Weakness Type\n\nCWE-77 Improper Neutralization of Special Elements used in a Command ('Command\nInjection')\n\n### Solution\n\nThis issue will be fixed in hotfix releases of PAN-OS 10.2.9-h1 (ETA: By\n4/14), PAN-OS 11.0.4-h1 (ETA: By 4/14), and PAN-OS 11.1.2-h3 (ETA: By 4/14),\nand in all later PAN-OS versions.\n\n### Workarounds and Mitigations\n\nRecommended Mitigation: Customers with a Threat Prevention subscription can\nblock attacks for this vulnerability by enabling Threat ID 95187 (introduced\nin Applications and Threats content version 8833-8682).\n\nIn addition to enabling Threat ID 95187, customers must ensure vulnerability\nprotection has been applied to their GlobalProtect interface to prevent\nexploitation of this issue on their device. Please see\nhttps://live.paloaltonetworks.com/t5/globalprotect-articles/applying-\nvulnerability-protection-to-globalprotect-interfaces/ta-p/340184 for more\ninformation.\n\nIf you are unable to apply the Threat Prevention based mitigation at this\ntime, you can still mitigate the impact of this vulnerability by temporarily\ndisabling device telemetry until the device is upgraded to a fixed PAN-OS\nversion. Once upgraded, device telemetry should be re-enabled on the device.\n\nPlease see the following page for details on how to temporarily disable device\ntelemetry: https://docs.paloaltonetworks.com/pan-os/11-0/pan-os-admin/device-\ntelemetry/device-telemetry-configure/device-telemetry-disable.\n\n### Acknowledgments\n\nPalo Alto Networks thanks Volexity for detecting and identifying this issue.\n\n### Frequently Asked Questions\n\n#### Q. Has this issue been exploited in the wild?\n\n> Palo Alto Networks is aware of a limited number of attacks that leverage the\n> exploitation of this vulnerability.\n\n#### Q. Has my device been compromised by this vulnerability?\n\n> Customers are able to open a case in the Customer Support Portal (CSP) and\n> upload a technical support file (TSF) to determine if their device logs\n> match known indicators of compromise (IoC) for this vulnerability.\n\n### Timeline\n\nInitial publication\n\nTerms of usePrivacyProduct Security Assurance and Vulnerability Disclosure\nPolicy Report vulnerabilitiesManage subscriptions\n\n\u00a9 2024 Palo Alto Networks, Inc. All rights reserved.\n\n", "frontpage": true}
