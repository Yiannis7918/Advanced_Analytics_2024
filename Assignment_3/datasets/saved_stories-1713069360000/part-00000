{"aid": "40026789", "title": "We ensure Cloudflare customers aren't affected by LE's certificate chain change", "url": "https://blog.cloudflare.com/shortening-lets-encrypt-change-of-trust-no-impact-to-cloudflare-customers", "domain": "cloudflare.com", "votes": 5, "user": "stanleydrew", "posted_at": "2024-04-13 22:33:31", "comments": 2, "source_title": "How we ensure Cloudflare customers aren't affected by Let's Encrypt's certificate chain change", "source_text": "How we ensure Cloudflare customers aren't affected by Let's Encrypt's\ncertificate chain change\n\nGet Started Free|Contact Sales\n\n## The Cloudflare Blog\n\nSubscribe to receive notifications of new posts:\n\n# How we ensure Cloudflare customers aren't affected by Let's Encrypt's\ncertificate chain change\n\n04/12/2024\n\n  * Dina Kozlov\n\n11 min read\n\nLet\u2019s Encrypt, a publicly trusted certificate authority (CA) that Cloudflare\nuses to issue TLS certificates, has been relying on two distinct certificate\nchains. One is cross-signed with IdenTrust, a globally trusted CA that has\nbeen around since 2000, and the other is Let\u2019s Encrypt\u2019s own root CA, ISRG\nRoot X1. Since Let\u2019s Encrypt launched, ISRG Root X1 has been steadily gaining\nits own device compatibility.\n\nOn September 30, 2024, Let\u2019s Encrypt\u2019s certificate chain cross-signed with\nIdenTrust will expire. After the cross-sign expires, servers will no longer be\nable to serve certificates signed by the cross-signed chain. Instead, all\nLet\u2019s Encrypt certificates will use the ISRG Root X1 CA.\n\nMost devices and browser versions released after 2016 will not experience any\nissues as a result of the change since the ISRG Root X1 will already be\ninstalled in those clients\u2019 trust stores. That's because these modern browsers\nand operating systems were built to be agile and flexible, with upgradeable\ntrust stores that can be updated to include new certificate authorities.\n\nThe change in the certificate chain will impact legacy devices and systems,\nsuch as devices running Android version 7.1.1 (released in 2016) or older, as\nthose exclusively rely on the cross-signed chain and lack the ISRG X1 root in\ntheir trust store. These clients will encounter TLS errors or warnings when\naccessing domains secured by a Let\u2019s Encrypt certificate. We took a look at\nthe data ourselves and found that, of all Android requests, 2.96% of them come\nfrom devices that will be affected by the change. That\u2019s a substantial portion\nof traffic that will lose access to the Internet. We\u2019re committed to keeping\nthose users online and will modify our certificate pipeline so that we can\ncontinue to serve users on older devices without requiring any manual\nmodifications from our customers.\n\n### A better Internet, for everyone\n\nIn the past, we invested in efforts like \u201cNo Browsers Left Behind\u201d to help\nensure that we could continue to support clients as SHA-1 based algorithms\nwere being deprecated. Now, we\u2019re applying the same approach for the upcoming\nLet\u2019s Encrypt change.\n\nWe have made the decision to remove Let\u2019s Encrypt as a certificate authority\nfrom all flows where Cloudflare dictates the CA, impacting Universal SSL\ncustomers and those using SSL for SaaS with the \u201cdefault CA\u201d choice.\n\nStarting in June 2024, one certificate lifecycle (90 days) before the cross-\nsign chain expires, we\u2019ll begin migrating Let\u2019s Encrypt certificates that are\nup for renewal to use a different CA, one that ensures compatibility with\nolder devices affected by the change. That means that going forward, customers\nwill only receive Let\u2019s Encrypt certificates if they explicitly request Let\u2019s\nEncrypt as the CA.\n\nThe change that Let's Encrypt is making is a necessary one. For us to move\nforward in supporting new standards and protocols, we need to make the Public\nKey Infrastructure (PKI) ecosystem more agile. By retiring the cross-signed\nchain, Let\u2019s Encrypt is pushing devices, browsers, and clients to support\nadaptable trust stores.\n\nHowever, we\u2019ve observed changes like this in the past and while they push the\nadoption of new standards, they disproportionately impact users in\neconomically disadvantaged regions, where access to new technology is limited.\n\nOur mission is to help build a better Internet and that means supporting users\nworldwide. We previously published a blog post about the Let\u2019s Encrypt change,\nasking customers to switch their certificate authority if they expected any\nimpact. However, determining the impact of the change is challenging. Error\nrates due to trust store incompatibility are primarily logged on clients,\nreducing the visibility that domain owners have. In addition, while there\nmight be no requests incoming from incompatible devices today, it doesn\u2019t\nguarantee uninterrupted access for a user tomorrow.\n\nCloudflare\u2019s certificate pipeline has evolved over the years to be resilient\nand flexible, allowing us to seamlessly adapt to changes like this without any\nnegative impact to our customers.\n\n### How Cloudflare has built a robust TLS certificate pipeline\n\nToday, Cloudflare manages tens of millions of certificates on behalf of\ncustomers. For us, a successful pipeline means:\n\n  1. Customers can always obtain a TLS certificate for their domain\n  2. CA related issues have zero impact on our customer\u2019s ability to obtain a certificate\n  3. The best security practices and modern standards are utilized\n  4. Optimizing for future scale\n  5. Supporting a wide range of clients and devices\n\nEvery year, we introduce new optimizations into our certificate pipeline to\nmaintain the highest level of service. Here\u2019s how we do it...\n\n### Ensuring customers can always obtain a TLS certificate for their domain\n\nSince the launch of Universal SSL in 2014, Cloudflare has been responsible for\nissuing and serving a TLS certificate for every domain that\u2019s protected by our\nnetwork. That might seem trivial, but there are a few steps that have to\nsuccessfully execute in order for a domain to receive a certificate:\n\n  1. Domain owners need to complete Domain Control Validation for every certificate issuance and renewal.\n  2. The certificate authority needs to verify the Domain Control Validation tokens to issue the certificate.\n  3. CAA records, which dictate which CAs can be used for a domain, need to be checked to ensure only authorized parties can issue the certificate.\n  4. The certificate authority must be available to issue the certificate.\n\nEach of these steps requires coordination across a number of parties \u2014 domain\nowners, CDNs, and certificate authorities. At Cloudflare, we like to be in\ncontrol when it comes to the success of our platform. That\u2019s why we make it\nour job to ensure each of these steps can be successfully completed.\n\nWe ensure that every certificate issuance and renewal requires minimal effort\nfrom our customers. To get a certificate, a domain owner has to complete\nDomain Control Validation (DCV) to prove that it does in fact own the domain.\nOnce the certificate request is initiated, the CA will return DCV tokens which\nthe domain owner will need to place in a DNS record or an HTTP token. If\nyou\u2019re using Cloudflare as your DNS provider, Cloudflare completes DCV on your\nbehalf by automatically placing the TXT token returned from the CA into your\nDNS records. Alternatively, if you use an external DNS provider, we offer the\noption to Delegate DCV to Cloudflare for automatic renewals without any\ncustomer intervention.\n\nOnce DCV tokens are placed, Certificate Authorities (CAs) verify them. CAs\nconduct this verification from multiple vantage points to prevent spoofing\nattempts. However, since these checks are done from multiple countries and\nASNs (Autonomous Systems), they may trigger a Cloudflare WAF rule which can\ncause the DCV check to get blocked. We made sure to update our WAF and\nsecurity engine to recognize that these requests are coming from a CA to\nensure they're never blocked so DCV can be successfully completed.\n\nSome customers have CA preferences, due to internal requirements or compliance\nregulations. To prevent an unauthorized CA from issuing a certificate for a\ndomain, the domain owner can create a Certification Authority Authorization\n(CAA) DNS record, specifying which CAs are allowed to issue a certificate for\nthat domain. To ensure that customers can always obtain a certificate, we\ncheck the CAA records before requesting a certificate to know which CAs we\nshould use. If the CAA records block all of the CAs that are available in\nCloudflare\u2019s pipeline and the customer has not uploaded a certificate from the\nCA of their choice, then we add CAA records on our customers\u2019 behalf to ensure\nthat they can get a certificate issued. Where we can, we optimize for\npreference. Otherwise, it\u2019s our job to prevent an outage by ensuring that\nthere\u2019s always a TLS certificate available for the domain, even if it does not\ncome from a preferred CA.\n\nToday, Cloudflare is not a publicly trusted certificate authority, so we rely\non the CAs that we use to be highly available. But, 100% uptime is an\nunrealistic expectation. Instead, our pipeline needs to be prepared in case\nour CAs become unavailable.\n\n#### Ensuring that CA-related issues have zero impact on our customer\u2019s\nability to obtain a certificate\n\nAt Cloudflare, we like to think ahead, which means preventing incidents before\nthey happen. It\u2019s not uncommon for CAs to become unavailable \u2014 sometimes this\nhappens because of an outage, but more commonly, CAs have maintenance periods\nevery so often where they become unavailable for some period of time.\n\nIt\u2019s our job to ensure CA redundancy, which is why we always have multiple CAs\nready to issue a certificate, ensuring high availability at all times. If\nyou've noticed different CAs issuing your Universal SSL certificates, that's\nintentional. We evenly distribute the load across our CAs to avoid any single\npoint of failure. Plus, we keep a close eye on latency and error rates to\ndetect any issues and automatically switch to a different CA that's available\nand performant. You may not know this, but one of our CAs has around 4\nscheduled maintenance periods every month. When this happens, our automated\nsystems kick in seamlessly, keeping everything running smoothly. This works so\nwell that our internal teams don\u2019t get paged anymore because everything just\nworks.\n\n#### Adopting best security practices and modern standards\n\nSecurity has always been, and will continue to be, Cloudflare\u2019s top priority,\nand so maintaining the highest security standards to safeguard our customer\u2019s\ndata and private keys is crucial.\n\nOver the past decade, the CA/Browser Forum has advocated for reducing\ncertificate lifetimes from 5 years to 90 days as the industry norm. This shift\nhelps minimize the risk of a key compromise. When certificates are renewed\nevery 90 days, their private keys remain valid for only that period, reducing\nthe window of time that a bad actor can make use of the compromised material.\n\nWe fully embrace this change and have made 90 days the default certificate\nvalidity period. This enhances our security posture by ensuring regular key\nrotations, and has pushed us to develop tools like DCV Delegation that promote\nautomation around frequent certificate renewals, without the added overhead.\nIt\u2019s what enables us to offer certificates with validity periods as low as two\nweeks, for customers that want to rotate their private keys at a high\nfrequency without any concern that it will lead to certificate renewal\nfailures.\n\nCloudflare has always been at the forefront of new protocols and standards.\nIt\u2019s no secret that when we support a new protocol, adoption skyrockets. This\nmonth, we will be adding ECDSA support for certificates issued from Google\nTrust Services. With ECDSA, you get the same level of security as RSA but with\nsmaller keys. Smaller keys mean smaller certificates and less data passed\naround to establish a TLS connection, which results in quicker connections and\nfaster loading times.\n\n#### Optimizing for future scale\n\nToday, Cloudflare issues almost 1 million certificates per day. With the\nrecent shift towards shorter certificate lifetimes, we continue to improve our\npipeline to be more robust. But even if our pipeline can handle the\nsignificant load, we still need to rely on our CAs to be able to scale with\nus. With every CA that we integrate, we instantly become one of their biggest\nconsumers. We hold our CAs to high standards and push them to improve their\ninfrastructure to scale. This doesn\u2019t just benefit Cloudflare\u2019s customers, but\nit helps the Internet by requiring CAs to handle higher volumes of issuance.\n\nAnd now, with Let\u2019s Encrypt shortening their chain of trust, we\u2019re going to\nadd an additional improvement to our pipeline \u2014 one that will ensure the best\ndevice compatibility for all.\n\n#### Supporting all clients \u2014 legacy and modern\n\nThe upcoming Let\u2019s Encrypt change will prevent legacy devices from making\nrequests to domains or applications that are protected by a Let\u2019s Encrypt\ncertificate. We don\u2019t want to cut off Internet access from any part of the\nworld, which means that we\u2019re going to continue to provide the best device\ncompatibility to our customers, despite the change.\n\nBecause of all the recent enhancements, we are able to reduce our reliance on\nLet\u2019s Encrypt without impacting the reliability or quality of service of our\ncertificate pipeline. One certificate lifecycle (90 days) before the change,\nwe are going to start shifting certificates to use a different CA, one that\u2019s\ncompatible with the devices that will be impacted. By doing this, we\u2019ll\nmitigate any impact without any action required from our customers. The only\ncustomers that will continue to use Let\u2019s Encrypt are ones that have\nspecifically chosen Let\u2019s Encrypt as the CA.\n\n### What to expect of the upcoming Let\u2019s Encrypt change\n\nLet\u2019s Encrypt\u2019s cross-signed chain will expire on September 30th, 2024.\nAlthough Let\u2019s Encrypt plans to stop issuing certificates from this chain on\nJune 6th, 2024, Cloudflare will continue to serve the cross-signed chain for\nall Let\u2019s Encrypt certificates until September 9th, 2024.\n\n90 days or one certificate lifecycle before the change, we are going to start\nshifting Let\u2019s Encrypt certificates to use a different certificate authority.\nWe\u2019ll make this change for all products where Cloudflare is responsible for\nthe CA selection, meaning this will be automatically done for customers using\nUniversal SSL and SSL for SaaS with the \u201cdefault CA\u201d choice.\n\nAny customers that have specifically chosen Let\u2019s Encrypt as their CA will\nreceive an email notification with a list of their Let\u2019s Encrypt certificates\nand information on whether or not we\u2019re seeing requests on those hostnames\ncoming from legacy devices.\n\nAfter September 9th, 2024, Cloudflare will serve all Let\u2019s Encrypt\ncertificates using the ISRG Root X1 chain. Here is what you should expect\nbased on the certificate product that you\u2019re using:\n\n#### Universal SSL\n\nWith Universal SSL, Cloudflare chooses the CA that is used for the domain\u2019s\ncertificate. This gives us the power to choose the best certificate for our\ncustomers. If you are using Universal SSL, there are no changes for you to\nmake to prepare for this change. Cloudflare will automatically shift your\ncertificate to use a more compatible CA.\n\n#### Advanced Certificates\n\nWith Advanced Certificate Manager, customers specifically choose which CA they\nwant to use. If Let\u2019s Encrypt was specifically chosen as the CA for a\ncertificate, we will respect the choice, because customers may have\nspecifically chosen this CA due to internal requirements, or because they have\nimplemented certificate pinning, which we highly discourage.\n\nIf we see that a domain using an Advanced certificate issued from Let\u2019s\nEncrypt will be impacted by the change, then we will send out email\nnotifications to inform those customers which certificates are using Let\u2019s\nEncrypt as their CA and whether or not those domains are receiving requests\nfrom clients that will be impacted by the change. Customers will be\nresponsible for changing the CA to another provider, if they chose to do so.\n\n#### SSL for SaaS\n\nWith SSL for SaaS, customers have two options: using a default CA, meaning\nCloudflare will choose the issuing authority, or specifying which CA to use.\n\nIf you\u2019re leaving the CA choice up to Cloudflare, then we will automatically\nuse a CA with higher device compatibility.\n\nIf you\u2019re specifying a certain CA for your custom hostnames, then we will\nrespect that choice. We will send an email out to SaaS providers and platforms\nto inform them which custom hostnames are receiving requests from legacy\ndevices. Customers will be responsible for changing the CA to another\nprovider, if they chose to do so.\n\n#### Custom Certificates\n\nIf you directly integrate with Let\u2019s Encrypt and use Custom Certificates to\nupload your Let\u2019s Encrypt certs to Cloudflare then your certificates will be\nbundled with the cross-signed chain, as long as you choose the bundle method\n\u201ccompatible\u201d or \u201cmodern\u201d and upload those certificates before September 9th,\n2024. After September 9th, we will bundle all Let\u2019s Encrypt certificates with\nthe ISRG Root X1 chain. With the \u201cuser-defined\u201d bundle method, we always serve\nthe chain that\u2019s uploaded to Cloudflare. If you upload Let\u2019s Encrypt\ncertificates using this method, you will need to ensure that certificates\nuploaded after September 30th, 2024, the date of the CA expiration, contain\nthe right certificate chain.\n\nIn addition, if you control the clients that are connecting to your\napplication, we recommend updating the trust store to include the ISRG Root\nX1. If you use certificate pinning, remove or update your pin. In general, we\ndiscourage all customers from pinning their certificates, as this usually\nleads to issues during certificate renewals or CA changes.\n\n## Conclusion\n\nInternet standards will continue to evolve and improve. As we support and\nembrace those changes, we also need to recognize that it\u2019s our responsibility\nto keep users online and to maintain Internet access in the parts of the world\nwhere new technology is not readily available. By using Cloudflare, you always\nhave the option to choose the setup that\u2019s best for your application.\n\nFor additional information regarding the change, please refer to our developer\ndocumentation.\n\nWe protect entire corporate networks, help customers build Internet-scale\napplications efficiently, accelerate any website or Internet application, ward\noff DDoS attacks, keep hackers at bay, and can help you on your journey to\nZero Trust.\n\nVisit 1.1.1.1 from any device to get started with our free app that makes your\nInternet faster and safer.\n\nTo learn more about our mission to help build a better Internet, start here.\nIf you're looking for a new career direction, check out our open positions.\n\nDiscuss on Hacker News\n\nSecurityApplication ServicesTLSSSLCertificate AuthorityDeep Dive\n\nFollow on X\n\nDina Kozlov|@dinasaur_404\n\nCloudflare|@cloudflare\n\nRelated posts\n\nApril 02, 2024 5:00 PM\n\n## Continuing our work with CISA and the Joint Cyber Defense Collaborative to\nkeep vulnerable communities secure online\n\nAlong with CISA and the Joint Cyber Defense Collaborative, we are spotlighting\nthreats to civil society, best practices for online protection, and new\nresources specifically for these vulnerable communities. Find out more about\nour latest initiatives....\n\nBy\n\n  * Jocelyn Woolbright\n\nSecurity, Project Galileo\n\nMarch 26, 2024 1:00 PM\n\n## From .com to .beauty: The evolving threat landscape of unwanted email\n\nIn this 2023-early 2024 email analysis, we examine how certain generic Top-\nLevel Domains (TLDs) are primarily used for spam and phishing, and their\nevolution over a year. There are many trends in email threats to examine...\n\nBy\n\n  * Jo\u00e3o Tom\u00e9\n\nEmail, Cloud Email Security, Security, Cloudflare Radar, Phishing\n\nMarch 14, 2024 2:00 PM\n\n## Upcoming Let\u2019s Encrypt certificate chain change and impact for Cloudflare\ncustomers\n\nLet\u2019s Encrypt\u2019s cross-signed chain will be expiring in September. To prepare\nfor the change, after May 15th, 2024, Cloudflare will start issuing certs from\nLet\u2019s Encrypt\u2019s ISRG X1 chain. This change will impact legacy devices with\noutdated trust stores (Android versions 7.1.1 or older)...\n\nBy\n\n  * Dina Kozlov\n\nSecurity, Developers, Developer Platform, SSL, TLS, Application Security\n\nMarch 08, 2024 2:05 PM\n\n## Log Explorer: monitor security events without third-party storage\n\nWith the combined power of Security Analytics + Log Explorer, security teams\ncan analyze, investigate, and monitor for security attacks natively within\nCloudflare, reducing time to resolution and overall cost of ownership for\ncustomers by eliminating the need to forward logs to third-party SIEMs...\n\nBy\n\n  * Jen Sells,\n\n  * Claudio Jolowicz,\n\n  * Cole MacKenzie\n\nSecurity Week, Analytics, Logs, Security, R2 Storage, SIEM, Product News\n\n  * Sales\n  * Enterprise Sales\n  * Become a Partner\n\nContact Sales:\n\n+1 (888) 993-5273\n\n  * Getting Started\n  * Pricing\n  * Case Studies\n  * White Papers\n  * Webinars\n  * Learning Center\n\n  * Community\n  * Community Hub\n  * Project Galileo\n  * Athenian Project\n  * Cloudflare TV\n\n  * Developers\n  * Developer Hub\n  * Developers Discord\n  * Cloudflare Workers\n  * Integrations\n\n  * Tools\n  * Cloudflare Radar\n  * Speed Test\n  * Is BGP Safe Yet?\n  * RPKI Toolkit\n  * Certificate Transparency\n\n  * Support\n  * Support\n  * Cloudflare Status\n  * Compliance\n  * GDPR\n\n  * Company\n  * About Cloudflare\n  * Our Team\n  * Press\n  * Analysts\n  * Careers\n  * Logo\n  * Network Map\n\n\u00a9 2024 Cloudflare, Inc. | Privacy Policy | Terms of Use |Cookie Preferences| Trust & Safety | Trademark\n\n## Our site uses cookies\n\nLike most websites, we use cookies to make our site work the way you expect it\nto, improve your experience on our site, analyze site usage, and assist in our\nmarketing efforts. By choosing \"Accept All Cookies\", you agree to the storing\nof all categories of cookies on your device. If you wish to accept or reject\nsome categories of cookies, please click \u201cCookie Preferences.\u201d\n\n## Your Cookie Options\n\nCloudflare uses four types of cookies as described below. You can decide which\ncategories of cookies you wish to accept to improve your experience on our\nwebsite. To learn more about the cookies we use on our site, please read our\nCookie Policy. Cloudflare's Cookie Policy\n\n### Manage Consent Preferences\n\n#### Strictly Necessary Cookies\n\nAlways Active\n\nStrictly Necessary cookies are essential to our website functioning as\nexpected. You cannot turn off Strictly Necessary cookies because they are\nrequired to deliver security, enable core site functionality, and help you use\nour site's features and services as you would expect (including remembering\nyour cookie consent preferences). Cloudflare does not use these cookies to\ntrack individuals across websites.\n\n#### Functional Cookies\n\nFunctional cookies allow us to remember choices you make about the kind of\nexperience you want on our site and to provide you with a more personalized\nexperience. For example, a functional cookie is required to remember which\nlanguage you prefer.\n\n#### Performance Cookies\n\nPerformance cookies help us learn how you use our website to help improve its\nperformance and design. These cookies provide us with aggregated statistical\ninformation such as number of page visits, page load speeds, how long a user\nspends on a particular page, and the types of browsers or devices used to\naccess our site.\n\n#### Targeting Cookies\n\nWe use Targeting cookies to deliver advertisements relevant to you and your\ninterests when you visit other websites that host advertisements.\n\n### Cookie List\n\nlabel\n\nConsent Leg.Interest\n\nlabel\n\nlabel\n\nlabel\n\n", "frontpage": true}
