{"aid": "40022970", "title": "SecOps Alert Enrichment: Recent related alerts", "url": "https://akatz.org/alert-enrichment-part-one-recent-related-alerts/", "domain": "akatz.org", "votes": 1, "user": "ackatz", "posted_at": "2024-04-13 13:21:24", "comments": 0, "source_title": "SecOps Alert Enrichment: Part 1 - Recent Related Alerts", "source_text": "SecOps Alert Enrichment: Part 1 - Recent Related Alerts\n\nSkip to Navigation Skip to Posts Skip to Content\n\nSubscribe\n\nSecOps Alert Enrichment: Part 1 - Recent Related Alerts\n\nsecurity\n\n# SecOps Alert Enrichment: Part 1 - Recent Related Alerts\n\nAndrew Katz April 12, 2024 3 min read\n\nThe alert factory where all the alerts get enriched\n\nThis is the first post in a series on SecOps Alert Enrichment.\n\nThe premise of this series is that, although many SecOps teams have\nimplemented basic alert enrichment, I submit that there are a lot of other\nniche, high-value enrichment use cases that teams out there may have not\nconsidered yet.\n\nI am not saying any of these ideas are novel, but if you look at any blog post\nor canned SOAR playbooks related to alert enrichment, there is a very good\nchance it is just another re-hashed example of looking up an IP or a hash from\nan alert in VirusTotal.\n\n## Example\n\nThis is an example of an enriched alert where the enriched data is prepended\nto the alert using the AbuseIPDB/VirusTotal example \ud83d\ude03\n\n    \n    \n    === START - ALERT ENRICHMENT v1.23 === AbuseIPDB IP Lookup - - - - - - - - - - - - - - - - - - - IP: 1.2.3.4 Abuse Confidence Score: 0 Total Reports: 0 VirusTotal IP Lookup - - - - - - - - - - - - - - - - - - - IP: 1.2.3.4 ASN: America Online Country: US VirusTotal Reputation: 0 Combined Malicious/Suspicious Score: 0 === END - ALERT ENRICHMENT === [...original alert data...]\n\nAnd now... onto the main content of this post!\n\n## Recent Related Alerts Enrichment\n\nThe idea behind this enrichment is that you take various IOCs from the alert\n(IPs, hashes, usernames, etc.) and then make an API call to your alert\nplatform to return the last 5 alerts where those IOCs were mentioned.\n\nThis can help answer the following questions:\n\n  * Have we seen this indicator before and why?\n  * When was the last time we saw this indicator?\n  * What did the last person who triaged an alert with this indicator say about it?\n\nAtlassian OpsGenie is one platform that is capable of providing this data back\nvia API. You can make a GET request to the OpsGenie Alerts API with these\nparameters:\n\n    \n    \n    { \"limit\": \"5\", \"query\": \"description: \\\"1.2.3.4\\\" NOT alertId: [current alert ID]\" }\n\nIf 1.2.3.4 is found within the body of any alert (except the current alert),\nOpsGenie will return the last 5 alerts where this is the case.\n\nThere are a number of different IOCs you can try to search for related alerts\nfor:\n\n  * a username\n  * a public IP\n  * a private IP\n  * a SHA256 hash\n  * other types of hashes\n  * instance names\n  * serial numbers\n  * AWS account names\n  * and more!\n\nWhen the alert is enriched with this information, it may look something like\nthis:\n\n\ud83d\udca1\n\nNote: The string Execution:Runtime/NewBinaryExecuted in the alert below would\nbe a clickable link to open the related alert\n\n    \n    \n    === START - ALERT ENRICHMENT v1.23 === Recent related alerts for SHA256 hashes - - - - - - - - - - - - b4e9653300309bf2218e5f6e4061c16c8569751fc90444f95f35409c18052cf1 - - - #54321: Execution:Runtime/NewBinaryExecuted (1 month ago) === END - ALERT ENRICHMENT === [...original alert data...]\n\n## Scenario\n\nLet's say that we received the GuardDuty alert\nExecution:Runtime/NewBinaryExecuted, and it is enriched with the alert\nenrichment shown above.\n\nLooking at the alert enrichment we can see that the SHA256 hash found in our\ncurrent Execution:Runtime/NewBinaryExecuted alert exists in another\nExecution:Runtime/NewBinaryExecuted alert from a month ago.\n\nWe can quickly pop into the old alert using the link in the enrichment and see\nfrom the analyst's notes that the binary was completely harmless.\nAdditionally, we have verbal confirmation from the person who executed it that\nit was benign and what activity it was related to.\n\nInstead of having very little context on what the binary was, and waiting\naround for a response from someone for 30-45 minutes, we have an immediate\nthread to pull on that leads us to the answer that lets us close the alert in\na matter of seconds.\n\n## Summary\n\nThis is a great enrichment to add to your alerts because it harnesses the\ninformation of your past investigations. Every time you add notes to an alert\non what happened and why, this enrichment becomes even more useful since it\ncan potentially use that information in the future.\n\nStay tuned for more parts in this series!\n\n## Discussion\n\n## Become a Member\n\nClick here to subscribe!\n\nSecurity, Macs, and more\n\n\u00a9 2024 Andrew Katz\n\nBlog\n\nsecurity\n\n### SecOps Alert Enrichment: Part 1 - Recent Related Alerts\n\nApr 12, 2024 3 min read\n\nmac\n\n### Fixing macOS zsh Terminal History Settings\n\nOct 12, 2022 1 min read\n\ndev\n\n### Running Syncthing on Fly.io with Tailscale\n\nSep 12, 2022 8 min read\n\n", "frontpage": false}
