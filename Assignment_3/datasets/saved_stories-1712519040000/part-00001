{"aid": "39960717", "title": "Mixture-of-Depths: Dynamically allocating compute in transformers", "url": "https://arxiv.org/abs/2404.02258", "domain": "arxiv.org", "votes": 3, "user": "milliondreams", "posted_at": "2024-04-07 13:42:05", "comments": 0, "source_title": "Mixture-of-Depths: Dynamically allocating compute in transformer-based language models", "source_text": "[2404.02258] Mixture-of-Depths: Dynamically allocating compute in transformer-\nbased language models\n\nSkip to main content\n\nWe gratefully acknowledge support from the Simons Foundation, member\ninstitutions, and all contributors. Donate\n\n> cs > arXiv:2404.02258\n\n# Computer Science > Machine Learning\n\narXiv:2404.02258 (cs)\n\n[Submitted on 2 Apr 2024]\n\n# Title:Mixture-of-Depths: Dynamically allocating compute in transformer-based\nlanguage models\n\nAuthors:David Raposo, Sam Ritter, Blake Richards, Timothy Lillicrap, Peter\nConway Humphreys, Adam Santoro\n\nView a PDF of the paper titled Mixture-of-Depths: Dynamically allocating\ncompute in transformer-based language models, by David Raposo and 5 other\nauthors\n\nView PDF HTML (experimental)\n\n> Abstract:Transformer-based language models spread FLOPs uniformly across\n> input sequences. In this work we demonstrate that transformers can instead\n> learn to dynamically allocate FLOPs (or compute) to specific positions in a\n> sequence, optimising the allocation along the sequence for different layers\n> across the model depth. Our method enforces a total compute budget by\n> capping the number of tokens (k) that can participate in the self-attention\n> and MLP computations at a given layer. The tokens to be processed are\n> determined by the network using a top-k routing mechanism. Since k is\n> defined a priori, this simple procedure uses a static computation graph with\n> known tensor sizes, unlike other conditional computation techniques.\n> Nevertheless, since the identities of the k tokens are fluid, this method\n> can expend FLOPs non-uniformly across the time and model depth dimensions.\n> Thus, compute expenditure is entirely predictable in sum total, but dynamic\n> and context-sensitive at the token-level. Not only do models trained in this\n> way learn to dynamically allocate compute, they do so efficiently. These\n> models match baseline performance for equivalent FLOPS and wall-clock times\n> to train, but require a fraction of the FLOPs per forward pass, and can be\n> upwards of 50\\% faster to step during post-training sampling.\n\nSubjects:| Machine Learning (cs.LG); Computation and Language (cs.CL)  \n---|---  \nCite as:| arXiv:2404.02258 [cs.LG]  \n(or arXiv:2404.02258v1 [cs.LG] for this version)  \n  \n## Submission history\n\nFrom: Adam Santoro [view email] [v1] Tue, 2 Apr 2024 19:28:11 UTC (1,763 KB)\n\nFull-text links:\n\n## Access Paper:\n\nView a PDF of the paper titled Mixture-of-Depths: Dynamically allocating\ncompute in transformer-based language models, by David Raposo and 5 other\nauthors\n\n  * View PDF\n  * HTML (experimental)\n  * TeX Source\n  * Other Formats\n\nview license\n\nCurrent browse context:\n\ncs.LG\n\n< prev | next >\n\nnew | recent | 2404\n\nChange to browse by:\n\ncs cs.CL\n\n### References & Citations\n\n  * NASA ADS\n  * Google Scholar\n  * Semantic Scholar\n\na export BibTeX citation Loading...\n\n## BibTeX formatted citation\n\n\u00d7\n\nData provided by:\n\n### Bookmark\n\n# Bibliographic and Citation Tools\n\nBibliographic Explorer (What is the Explorer?)\n\nLitmaps (What is Litmaps?)\n\nscite Smart Citations (What are Smart Citations?)\n\n# Code, Data and Media Associated with this Article\n\nCatalyzeX Code Finder for Papers (What is CatalyzeX?)\n\nDagsHub (What is DagsHub?)\n\nGotit.pub (What is GotitPub?)\n\nPapers with Code (What is Papers with Code?)\n\nScienceCast (What is ScienceCast?)\n\n# Demos\n\nReplicate (What is Replicate?)\n\nHugging Face Spaces (What is Spaces?)\n\nTXYZ.AI (What is TXYZ.AI?)\n\n# Recommenders and Search Tools\n\nInfluence Flower (What are Influence Flowers?)\n\nConnected Papers (What is Connected Papers?)\n\nCORE Recommender (What is CORE?)\n\nIArxiv Recommender (What is IArxiv?)\n\n  * Author\n  * Venue\n  * Institution\n  * Topic\n\n# arXivLabs: experimental projects with community collaborators\n\narXivLabs is a framework that allows collaborators to develop and share new\narXiv features directly on our website.\n\nBoth individuals and organizations that work with arXivLabs have embraced and\naccepted our values of openness, community, excellence, and user data privacy.\narXiv is committed to these values and only works with partners that adhere to\nthem.\n\nHave an idea for a project that will add value for arXiv's community? Learn\nmore about arXivLabs.\n\nWhich authors of this paper are endorsers? | Disable MathJax (What is MathJax?)\n\n  * About\n  * Help\n\n  * Contact\n  * Subscribe\n\n  * Copyright\n  * Privacy Policy\n\n  * Web Accessibility Assistance\n  * arXiv Operational Status Get status notifications via email or slack\n\n", "frontpage": true}
