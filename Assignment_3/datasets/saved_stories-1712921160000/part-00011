{"aid": "40007985", "title": "Backdoor in XZ Utils That Almost Happened", "url": "https://www.lawfaremedia.org/article/backdoor-in-xz-utils-that-almost-happened", "domain": "lawfaremedia.org", "votes": 5, "user": "room505", "posted_at": "2024-04-11 23:43:14", "comments": 0, "source_title": "Backdoor in XZ Utils That Almost Happened", "source_text": "Backdoor in XZ Utils That Almost Happened | Lawfare\n\nSkip to Main Content\n\n  * Facebook\n  * Twitter\n  * LinkedIn\n\nThe upcoming main navigation can be gotten through utilizing the tab key. Any\nbuttons that open a sub navigation can be triggered by the space or enter key.\n\n## Search Lawfare\n\n###### Suggestions\n\nAdvanced Search\n\nCybersecurity & Tech\n\n# Backdoor in XZ Utils That Almost Happened\n\nBruce Schneier\n\nTuesday, April 9, 2024, 3:30 PM\n\nShare On: Share on Facebook Share on Twitter Share on LinkedIn\n\nThe recent cybersecurity catastrophe that wasn\u2019t reveals an untenable\nsituation, one being exploited by malicious actors.\n\nA reflection of a man typing on a laptop computer (Matthew Roth,\nhttps://commons.wikimedia.org/wiki/File:Typing_computer_screen_reflection.jpg;\nCC BY-SA 3.0 DEED; https://creativecommons.org/licenses/by-sa/3.0/deed.en)\n\n  * ## Bruce Schneier\n\nMeet The Authors\n\nPublished by The Lawfare Institute in Cooperation With\n\nSubscribe to Lawfare\n\nLast week, the internet dodged a major nation-state attack that would have had\ncatastrophic cybersecurity repercussions worldwide. It\u2019s a catastrophe that\ndidn\u2019t happen, so it won\u2019t get much attention\u2014but it should. There\u2019s an\nimportant moral to the story of the attack and its discovery: The security of\nthe global internet depends on countless obscure pieces of software written\nand maintained by even more obscure unpaid, distractible, and sometimes\nvulnerable volunteers. It\u2019s an untenable situation, and one that is being\nexploited by malicious actors. Yet precious little is being done to remedy it.\n\nProgrammers dislike doing extra work. If they can find already-written code\nthat does what they want, they\u2019re going to use it rather than recreate the\nfunctionality. These code repositories, called libraries, are hosted on sites\nlike GitHub. There are libraries for everything: displaying objects in 3D,\nspell-checking, performing complex mathematics, managing an e-commerce\nshopping cart, moving files around the internet\u2014everything. Libraries are\nessential to modern programming; they\u2019re the building blocks of complex\nsoftware. The modularity they provide makes software projects tractable.\nEverything you use contains dozens of these libraries: some commercial, some\nopen source and freely available. They are essential to the functionality of\nthe finished software. And to its security.\n\nYou\u2019ve likely never heard of an open-source library called XZ Utils, but it\u2019s\non hundreds of millions of computers. It\u2019s probably on yours. It\u2019s certainly\nin whatever corporate or organizational network you use. It\u2019s a freely\navailable library that does data compression. It\u2019s important, in the same way\nthat hundreds of other similar obscure libraries are important.\n\nMany open-source libraries, like XZ Utils, are maintained by volunteers. In\nthe case of XZ Utils, it\u2019s one person, named Lasse Collin. He has been in\ncharge of XZ Utils since he wrote it in 2009. And, at least in 2022, he\u2019s had\nsome \u201clongterm mental health issues.\u201d (To be clear, he is not to blame in this\nstory. This is a systems problem.)\n\nBeginning in at least 2021, Collin was personally targeted. We don\u2019t know by\nwhom, but we have account names: Jia Tan, Jigar Kumar, Dennis Ens. They\u2019re not\nreal names. They pressured Collin to transfer control over XZ Utils. In early\n2023, they succeeded. Tan spent the year slowly incorporating a backdoor into\nXZ Utils: disabling systems that might discover his actions, laying the\ngroundwork, and finally adding the complete backdoor earlier this year. On\nMarch 25, Hans Jansen\u2014another fake name\u2014tried to push the various Unix systems\nto upgrade to the new version of XZ Utils.\n\nAnd everyone was poised to do so. It\u2019s a routine update. In the span of a few\nweeks, it would have been part of both Debian and Red Hat Linux, which run on\nthe vast majority of servers on the internet. But on March 29, another unpaid\nvolunteer, Andres Freund\u2014a real person who works for Microsoft but who was\ndoing this in his spare time\u2014noticed something weird about how much processing\nthe new version of XZ Utils was doing. It\u2019s the sort of thing that could be\neasily overlooked, and even more easily ignored. But for whatever reason,\nFreund tracked down the weirdness and discovered the backdoor.\n\nIt\u2019s a masterful piece of work. It affects the SSH remote login protocol,\nbasically by adding a hidden piece of functionality that requires a specific\nkey to enable. Someone with that key can use the backdoored SSH to upload and\nexecute an arbitrary piece of code on the target machine. SSH runs as root, so\nthat code could have done anything. Let your imagination run wild.\n\nThis isn\u2019t something a hacker just whips up. This backdoor is the result of a\nyears-long engineering effort. The ways the code evades detection in source\nform, how it lies dormant and undetectable until activated, and its immense\npower and flexibility give credence to the widely held assumption that a major\nnation-state is behind this.\n\nIf it hadn\u2019t been discovered, it probably would have eventually ended up on\nevery computer and server on the internet. Though it\u2019s unclear whether the\nbackdoor would have affected Windows and Mac, it would have worked on Linux.\nRemember in 2020, when Russia planted a backdoor into SolarWinds that affected\n14,000 networks? That seemed like a lot, but this would have been orders of\nmagnitude more damaging. And again, the catastrophe was averted only because a\nvolunteer stumbled on it. And it was possible in the first place only because\nthe first unpaid volunteer, someone who turns out to be a national security\nsingle point of failure, was personally targeted and exploited by a foreign\nactor.\n\nThis is no way to run critical national infrastructure. And yet, here we are.\nThis was an attack on our software supply chain. This attack subverted\nsoftware dependencies. The SolarWinds attack targeted the update process.\nOther attacks target system design, development, and deployment. Such attacks\nare becoming increasingly common and effective, and also are increasingly the\nweapon of choice of nation-states.\n\nIt\u2019s impossible to count how many of these single points of failure are in our\ncomputer systems. And there\u2019s no way to know how many of the unpaid and\nunappreciated maintainers of critical software libraries are vulnerable to\npressure. (Again, don\u2019t blame them. Blame the industry that is happy to\nexploit their unpaid labor.) Or how many more have accidentally created\nexploitable vulnerabilities. How many other coercion attempts are ongoing? A\ndozen? A hundred? It seems impossible that the XZ Utils operation was a unique\ninstance.\n\nSolutions are hard. Banning open source won\u2019t work; it\u2019s precisely because XZ\nUtils is open source that an engineer discovered the problem in time. Banning\nsoftware libraries won\u2019t work, either; modern software can\u2019t function without\nthem. For years security engineers have been pushing something called a\n\u201csoftware bill of materials\u201d: an ingredients list of sorts so that when one of\nthese packages is compromised, network owners at least know if they\u2019re\nvulnerable. The industry hates this idea and has been fighting it for years,\nbut perhaps the tide is turning.\n\nThe fundamental problem is that tech companies dislike spending extra money\neven more than programmers dislike doing extra work. If there\u2019s free software\nout there, they are going to use it\u2014and they\u2019re not going to do much in-house\nsecurity testing. Easier software development equals lower costs equals more\nprofits. The market economy rewards this sort of insecurity.\n\nWe need some sustainable ways to fund open-source projects that become de\nfacto critical infrastructure. Public shaming can help here. The Open Source\nSecurity Foundation (OSSF), founded in 2022 after another critical\nvulnerability in an open-source library\u2014Log4j\u2014was discovered, addresses this\nproblem. The big tech companies pledged $30 million in funding after the\ncritical Log4j supply chain vulnerability, but they never delivered. And they\nare still happy to make use of all this free labor and free resources, as a\nrecent Microsoft anecdote indicates. The companies benefiting from these\nfreely available libraries need to actually step up, and the government can\nforce them to.\n\nThere\u2019s a lot of tech that could be applied to this problem, if corporations\nwere willing to spend the money. Liabilities will help. The Cybersecurity and\nInfrastructure Security Agency\u2019s (CISA\u2019s) \u201csecure by design\u201d initiative will\nhelp, and CISA is finally partnering with OSSF on this problem. Certainly the\nsecurity of these libraries needs to be part of any broad government\ncybersecurity initiative.\n\nWe got extraordinarily lucky this time, but maybe we can learn from the\ncatastrophe that didn\u2019t happen. Like the power grid, communications network,\nand transportation systems, the software supply chain is critical\ninfrastructure, part of national security, and vulnerable to foreign attack.\nThe U.S. government needs to recognize this as a national security problem and\nstart treating it as such.\n\nTopics:\n\nCybersecurity & Tech\n\nBack to Top\n\n### Bruce Schneier\n\nRead More\n\nBruce Schneier is an internationally renowned security technologist, called a\n\u201csecurity guru\u201d by the Economist. He is the New York Times best-selling author\nof 14 books \u2014 including \u201dClick Here to Kill Everybody\u201d\u2014as well as hundreds of\narticles, essays and academic papers.\n\n## More Articles\n\n  * ### The Pros and Cons of the House\u2019s Data Broker Bill\n\nJustin Sherman\n\nApr 11, 2024\n\nThe House is focused on important risks from the sale of Americans\u2019 data, but\nlegislators can pursue more comprehensive data brokerage measures.\n\n  * ### Rational Security: The \"Eldritch Portents\" Edition\n\nAlan Z. Rozenshtein Quinta Jurecic Molly E. Reynolds\n\nApr 11, 2024\n\nThis week, Alan Rozenshtein and Quinta Jurecic were joined again by Molly\nReynolds to talk over the week\u2019s national security news.\n\n  * ### Jawboning and the Limits of Government Advocacy\n\nOri Lev\n\nApr 11, 2024\n\nClear rules are hard to apply but especially necessary in these polarized\ntimes.\n\n## Other Topics\n\n  * Armed Conflict\n  * Congress\n  * Courts & Litigation\n  * Criminal Justice & Rule of Law\n  * Cybersecurity & Tech\n  * Democracy & Elections\n  * Executive Branch\n  * Foreign Relations & International Law\n  * Intelligence\n  * States & Localities\n  * Surveillance & Privacy\n  * Terrorism & Extremism\n\n## Subscribe to Lawfare\n\nHard National Security Choices\n\n  * Stay Connected\n  * Facebook\n  * Twitter\n  * LinkedIn\n  * Youtube\n\n## Lawfare\n\n## Resources\n\n## About\n\n\u00a9 2024\n\nThe Lawfare Institute\n\nPublished by The Lawfare Institute in Cooperation With\n\n\u00d7\n\n", "frontpage": true}
